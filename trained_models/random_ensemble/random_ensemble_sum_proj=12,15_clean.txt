
Loading mnist.
('x_train shape:', (60000, 28, 28, 1), '\nx_test shape:', (10000, 28, 28, 1))

Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (12, 60000, 8, 8, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 5ms/step - loss: 0.8075 - acc: 0.7411
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4654 - acc: 0.8565
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4011 - acc: 0.8747
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3568 - acc: 0.8882
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3357 - acc: 0.8940
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3117 - acc: 0.9032
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2974 - acc: 0.9073
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2881 - acc: 0.9111
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2718 - acc: 0.9153
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2674 - acc: 0.9160
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2526 - acc: 0.9218
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2498 - acc: 0.9219
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 5ms/step - loss: 0.8628 - acc: 0.7176
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4814 - acc: 0.8484
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4067 - acc: 0.8732
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3718 - acc: 0.8834
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3406 - acc: 0.8928
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3238 - acc: 0.8993
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3060 - acc: 0.9047
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2941 - acc: 0.9086
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2795 - acc: 0.9127
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2670 - acc: 0.9160
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2644 - acc: 0.9177
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2576 - acc: 0.9196
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 5ms/step - loss: 0.8301 - acc: 0.7323
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4647 - acc: 0.8559
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4002 - acc: 0.8774
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3644 - acc: 0.8875
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3356 - acc: 0.8950
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3153 - acc: 0.9022
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2950 - acc: 0.9076
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2862 - acc: 0.9106
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2706 - acc: 0.9171
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2641 - acc: 0.9176
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2610 - acc: 0.9174
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2487 - acc: 0.9226
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 6ms/step - loss: 0.8507 - acc: 0.7265
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4668 - acc: 0.8529
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4097 - acc: 0.8715
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3649 - acc: 0.8856
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3387 - acc: 0.8941
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3177 - acc: 0.8996
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3023 - acc: 0.9050
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2889 - acc: 0.9086
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2745 - acc: 0.9132
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2698 - acc: 0.9146
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2660 - acc: 0.9161
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2540 - acc: 0.9203
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 6ms/step - loss: 0.8311 - acc: 0.7361
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4763 - acc: 0.8519
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4048 - acc: 0.8739
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3708 - acc: 0.8848
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3425 - acc: 0.8933
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3148 - acc: 0.9015
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3114 - acc: 0.9016
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2824 - acc: 0.9112
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2799 - acc: 0.9119
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2701 - acc: 0.9160
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2588 - acc: 0.9185
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2551 - acc: 0.9191
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 6ms/step - loss: 0.8730 - acc: 0.7130
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4975 - acc: 0.8434
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4202 - acc: 0.8688
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3779 - acc: 0.8812
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3518 - acc: 0.8890
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3317 - acc: 0.8953
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3159 - acc: 0.9001
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3113 - acc: 0.9020
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2950 - acc: 0.9082
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2802 - acc: 0.9105
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2764 - acc: 0.9121
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2645 - acc: 0.9163
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 6ms/step - loss: 0.8051 - acc: 0.7401
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4518 - acc: 0.8597
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3840 - acc: 0.8817
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3488 - acc: 0.8920
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3200 - acc: 0.9008
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2977 - acc: 0.9072
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2894 - acc: 0.9097
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2789 - acc: 0.9150
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2658 - acc: 0.9181
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2584 - acc: 0.9197
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2484 - acc: 0.9237
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2406 - acc: 0.9249
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 6ms/step - loss: 0.7704 - acc: 0.7509
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4423 - acc: 0.8628
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3789 - acc: 0.8844
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3383 - acc: 0.8948
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3110 - acc: 0.9033
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2956 - acc: 0.9084
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2813 - acc: 0.9123
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2709 - acc: 0.9155
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2582 - acc: 0.9189
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2465 - acc: 0.9233
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2424 - acc: 0.9248
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2376 - acc: 0.9248
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 6ms/step - loss: 0.8264 - acc: 0.7333
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4677 - acc: 0.8545
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3987 - acc: 0.8773
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3593 - acc: 0.8873
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3270 - acc: 0.8998
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3104 - acc: 0.9035
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2937 - acc: 0.9091
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2843 - acc: 0.9118
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2721 - acc: 0.9155
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2628 - acc: 0.9178
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2571 - acc: 0.9199
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2405 - acc: 0.9261
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 7ms/step - loss: 0.8034 - acc: 0.7395
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4588 - acc: 0.8554
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3903 - acc: 0.8779
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3428 - acc: 0.8928
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3245 - acc: 0.8998
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3052 - acc: 0.9060
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2898 - acc: 0.9099
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2759 - acc: 0.9130
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2670 - acc: 0.9176
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2545 - acc: 0.9210
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2532 - acc: 0.9205
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2399 - acc: 0.9235
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 7ms/step - loss: 0.7964 - acc: 0.7444
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4617 - acc: 0.8546
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4049 - acc: 0.8765
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3591 - acc: 0.8888
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3287 - acc: 0.8986
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3064 - acc: 0.9033
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2978 - acc: 0.9070
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2818 - acc: 0.9121
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2685 - acc: 0.9166
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2561 - acc: 0.9202
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2541 - acc: 0.9202
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2524 - acc: 0.9201
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 7ms/step - loss: 0.7683 - acc: 0.7545
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4415 - acc: 0.8627
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3785 - acc: 0.8839
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3413 - acc: 0.8950
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3158 - acc: 0.9024
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2970 - acc: 0.9081
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2832 - acc: 0.9119
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2724 - acc: 0.9152
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2595 - acc: 0.9192
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2505 - acc: 0.9218
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2433 - acc: 0.9247
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2347 - acc: 0.9276
('\nTraining time for model (n_proj=', '12', ', size_proj=', '8', '): --- 337.230983019 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (12, 10000, 8, 8, 1))
Correctly classified: 9685
Incorrectly classified: 315
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.97      0.99      0.98       980
           1       0.99      0.99      0.99      1135
           2       0.96      0.96      0.96      1032
           3       0.97      0.97      0.97      1010
           4       0.96      0.97      0.97       982
           5       0.98      0.97      0.97       892
           6       0.97      0.97      0.97       958
           7       0.97      0.96      0.96      1028
           8       0.95      0.96      0.96       974
           9       0.96      0.94      0.95      1009

   micro avg       0.97      0.97      0.97     10000
   macro avg       0.97      0.97      0.97     10000
weighted avg       0.97      0.97      0.97     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (12, 10000, 8, 8, 1))

Adversarial test data.
Correctly classified: 5695
Incorrectly classified: 4305
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.91      0.81      0.86       980
           1       0.86      0.01      0.01      1135
           2       0.54      0.89      0.67      1032
           3       0.62      0.81      0.70      1010
           4       0.66      0.55      0.60       982
           5       0.77      0.60      0.67       892
           6       0.93      0.69      0.79       958
           7       0.95      0.41      0.57      1028
           8       0.27      0.87      0.41       974
           9       0.54      0.15      0.24      1009

   micro avg       0.57      0.57      0.57     10000
   macro avg       0.70      0.58      0.55     10000
weighted avg       0.70      0.57      0.54     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (12, 60000, 12, 12, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 5s 11ms/step - loss: 0.6298 - acc: 0.7992
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3073 - acc: 0.9061
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2610 - acc: 0.9203
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2293 - acc: 0.9307
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2032 - acc: 0.9368
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1904 - acc: 0.9413
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1782 - acc: 0.9449
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1701 - acc: 0.9468
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1584 - acc: 0.9502
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1549 - acc: 0.9515
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1473 - acc: 0.9542
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1446 - acc: 0.9543
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 5s 11ms/step - loss: 0.6490 - acc: 0.7951
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3184 - acc: 0.9019
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2625 - acc: 0.9181
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2341 - acc: 0.9275
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2070 - acc: 0.9371
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1911 - acc: 0.9402
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1811 - acc: 0.9425
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1688 - acc: 0.9473
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1642 - acc: 0.9485
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1509 - acc: 0.9518
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1431 - acc: 0.9548
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1424 - acc: 0.9533
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 5s 12ms/step - loss: 0.6165 - acc: 0.8056
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3053 - acc: 0.9074
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2517 - acc: 0.9234
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2230 - acc: 0.9302
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2033 - acc: 0.9365
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1918 - acc: 0.9408
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1778 - acc: 0.9440
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1595 - acc: 0.9500
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1552 - acc: 0.9517
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1435 - acc: 0.9547
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1417 - acc: 0.9551
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1349 - acc: 0.9578
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 12ms/step - loss: 0.6370 - acc: 0.7984
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3148 - acc: 0.9041
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2616 - acc: 0.9196
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2293 - acc: 0.9294
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2048 - acc: 0.9361
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1871 - acc: 0.9414
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1821 - acc: 0.9432
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1712 - acc: 0.9448
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1620 - acc: 0.9488
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1557 - acc: 0.9499
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1456 - acc: 0.9551
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1418 - acc: 0.9549
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 12ms/step - loss: 0.6295 - acc: 0.7998
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3124 - acc: 0.9042
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2660 - acc: 0.9196
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2298 - acc: 0.9304
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2080 - acc: 0.9351
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1913 - acc: 0.9403
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1792 - acc: 0.9428
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1692 - acc: 0.9485
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1622 - acc: 0.9489
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1512 - acc: 0.9513
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1454 - acc: 0.9548
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1360 - acc: 0.9578
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 12ms/step - loss: 0.6128 - acc: 0.8059
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3076 - acc: 0.9063
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2499 - acc: 0.9226
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2247 - acc: 0.9293
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2014 - acc: 0.9378
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1892 - acc: 0.9415
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1717 - acc: 0.9453
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1622 - acc: 0.9487
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1519 - acc: 0.9519
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1479 - acc: 0.9533
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1431 - acc: 0.9546
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1341 - acc: 0.9579
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 12ms/step - loss: 0.6480 - acc: 0.7950
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3234 - acc: 0.9028
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2572 - acc: 0.9204
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2237 - acc: 0.9318
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2002 - acc: 0.9386
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1864 - acc: 0.9422
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1752 - acc: 0.9450
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1673 - acc: 0.9466
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1544 - acc: 0.9527
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1523 - acc: 0.9528
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1449 - acc: 0.9554
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1415 - acc: 0.9550
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 13ms/step - loss: 0.6189 - acc: 0.8049
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3080 - acc: 0.9051
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2500 - acc: 0.9218
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2190 - acc: 0.9325
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1999 - acc: 0.9381
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1828 - acc: 0.9448
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1695 - acc: 0.9485
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1619 - acc: 0.9495
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1587 - acc: 0.9505
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1469 - acc: 0.9538
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1403 - acc: 0.9553
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1366 - acc: 0.9567
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 13ms/step - loss: 0.6259 - acc: 0.8045
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3061 - acc: 0.9061
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2565 - acc: 0.9213
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2234 - acc: 0.9312
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2034 - acc: 0.9383
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1905 - acc: 0.9416
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1756 - acc: 0.9462
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1626 - acc: 0.9485
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1519 - acc: 0.9522
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1501 - acc: 0.9529
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1455 - acc: 0.9554
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1383 - acc: 0.9570
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 13ms/step - loss: 0.6536 - acc: 0.7925
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3144 - acc: 0.9039
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2574 - acc: 0.9196
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2239 - acc: 0.9307
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2035 - acc: 0.9369
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1877 - acc: 0.9414
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1802 - acc: 0.9442
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1657 - acc: 0.9477
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1591 - acc: 0.9501
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1519 - acc: 0.9525
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1429 - acc: 0.9550
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1401 - acc: 0.9563
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 13ms/step - loss: 0.6185 - acc: 0.8052
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3080 - acc: 0.9059
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2530 - acc: 0.9224
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2251 - acc: 0.9298
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2052 - acc: 0.9367
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1872 - acc: 0.9414
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1750 - acc: 0.9442
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1688 - acc: 0.9481
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1573 - acc: 0.9504
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1496 - acc: 0.9523
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1442 - acc: 0.9544
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1397 - acc: 0.9561
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 14ms/step - loss: 0.5955 - acc: 0.8102
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2924 - acc: 0.9102
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2420 - acc: 0.9242
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2173 - acc: 0.9317
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1968 - acc: 0.9385
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1817 - acc: 0.9437
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1697 - acc: 0.9476
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1575 - acc: 0.9505
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1518 - acc: 0.9515
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1438 - acc: 0.9543
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1403 - acc: 0.9548
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1341 - acc: 0.9556
('\nTraining time for model (n_proj=', '12', ', size_proj=', '12', '): --- 608.353280067 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (12, 10000, 12, 12, 1))
Correctly classified: 9764
Incorrectly classified: 236
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.97      0.99      0.98       980
           1       0.99      0.99      0.99      1135
           2       0.97      0.97      0.97      1032
           3       0.98      0.98      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.99      0.97      0.98       892
           6       0.97      0.98      0.98       958
           7       0.97      0.97      0.97      1028
           8       0.97      0.97      0.97       974
           9       0.98      0.96      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (12, 10000, 12, 12, 1))

Adversarial test data.
Correctly classified: 6122
Incorrectly classified: 3878
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.96      0.81      0.88       980
           1       0.94      0.01      0.03      1135
           2       0.63      0.91      0.75      1032
           3       0.72      0.80      0.75      1010
           4       0.66      0.57      0.61       982
           5       0.76      0.70      0.73       892
           6       0.90      0.79      0.84       958
           7       0.93      0.52      0.67      1028
           8       0.28      0.91      0.43       974
           9       0.65      0.21      0.31      1009

   micro avg       0.61      0.61      0.61     10000
   macro avg       0.74      0.62      0.60     10000
weighted avg       0.75      0.61      0.59     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (12, 60000, 16, 16, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 20ms/step - loss: 0.5135 - acc: 0.8392
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2263 - acc: 0.9309
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1850 - acc: 0.9452
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1574 - acc: 0.9517
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1398 - acc: 0.9563
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1258 - acc: 0.9612
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1150 - acc: 0.9635
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1073 - acc: 0.9662
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0995 - acc: 0.9687
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0953 - acc: 0.9700
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0862 - acc: 0.9720
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0852 - acc: 0.9732
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 20ms/step - loss: 0.5188 - acc: 0.8386
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2367 - acc: 0.9289
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1868 - acc: 0.9432
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1593 - acc: 0.9508
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1409 - acc: 0.9558
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1305 - acc: 0.9592
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1156 - acc: 0.9634
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1054 - acc: 0.9674
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0983 - acc: 0.9688
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0921 - acc: 0.9706
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0849 - acc: 0.9728
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0839 - acc: 0.9728
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 21ms/step - loss: 0.5304 - acc: 0.8337
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2350 - acc: 0.9289
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1830 - acc: 0.9439
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1626 - acc: 0.9509
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1493 - acc: 0.9538
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1300 - acc: 0.9597
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1215 - acc: 0.9623
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1104 - acc: 0.9658
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1074 - acc: 0.9673
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0964 - acc: 0.9693
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0917 - acc: 0.9710
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0897 - acc: 0.9713
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 21ms/step - loss: 0.5390 - acc: 0.8306
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2341 - acc: 0.9291
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1848 - acc: 0.9444
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1630 - acc: 0.9498
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1425 - acc: 0.9560
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1244 - acc: 0.9619
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1188 - acc: 0.9621
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1081 - acc: 0.9666
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1007 - acc: 0.9685
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0962 - acc: 0.9700
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0927 - acc: 0.9717
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0899 - acc: 0.9720
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 21ms/step - loss: 0.5419 - acc: 0.8292
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2383 - acc: 0.9282
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1845 - acc: 0.9442
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1593 - acc: 0.9513
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1435 - acc: 0.9558
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1308 - acc: 0.9588
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1184 - acc: 0.9618
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1101 - acc: 0.9651
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1002 - acc: 0.9679
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0917 - acc: 0.9705
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0883 - acc: 0.9718
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0826 - acc: 0.9734
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 22ms/step - loss: 0.5507 - acc: 0.8259
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2414 - acc: 0.9276
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1928 - acc: 0.9415
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1668 - acc: 0.9495
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1445 - acc: 0.9549
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1312 - acc: 0.9583
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1247 - acc: 0.9621
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1113 - acc: 0.9651
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1050 - acc: 0.9676
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0997 - acc: 0.9687
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0984 - acc: 0.9694
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0909 - acc: 0.9711
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 22ms/step - loss: 0.5351 - acc: 0.8323
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2386 - acc: 0.9287
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1890 - acc: 0.9422
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1567 - acc: 0.9518
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1455 - acc: 0.9546
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1315 - acc: 0.9591
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1175 - acc: 0.9636
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1067 - acc: 0.9663
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0998 - acc: 0.9685
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0978 - acc: 0.9695
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0915 - acc: 0.9705
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0906 - acc: 0.9715
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 22ms/step - loss: 0.5451 - acc: 0.8299
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2384 - acc: 0.9282
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1871 - acc: 0.9438
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1653 - acc: 0.9494
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1396 - acc: 0.9573
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1256 - acc: 0.9614
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1173 - acc: 0.9635
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1073 - acc: 0.9663
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1015 - acc: 0.9672
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0940 - acc: 0.9701
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0886 - acc: 0.9719
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0847 - acc: 0.9727
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 22ms/step - loss: 0.5288 - acc: 0.8335
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2377 - acc: 0.9296
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1901 - acc: 0.9417
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1624 - acc: 0.9498
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1453 - acc: 0.9543
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1287 - acc: 0.9602
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1194 - acc: 0.9626
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1115 - acc: 0.9645
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1051 - acc: 0.9672
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0948 - acc: 0.9699
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0881 - acc: 0.9727
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0831 - acc: 0.9734
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 11s 23ms/step - loss: 0.5322 - acc: 0.8340
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2265 - acc: 0.9321
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1800 - acc: 0.9448
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1572 - acc: 0.9520
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1397 - acc: 0.9570
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1270 - acc: 0.9614
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1142 - acc: 0.9642
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1068 - acc: 0.9664
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0982 - acc: 0.9694
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0933 - acc: 0.9700
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0913 - acc: 0.9708
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0803 - acc: 0.9742
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 11s 23ms/step - loss: 0.5345 - acc: 0.8338
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2351 - acc: 0.9297
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1860 - acc: 0.9431
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1603 - acc: 0.9518
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1419 - acc: 0.9555
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1324 - acc: 0.9590
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1145 - acc: 0.9646
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1078 - acc: 0.9651
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1060 - acc: 0.9667
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0941 - acc: 0.9701
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0916 - acc: 0.9706
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0858 - acc: 0.9730
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 11s 23ms/step - loss: 0.5441 - acc: 0.8306
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2398 - acc: 0.9263
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1899 - acc: 0.9439
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1610 - acc: 0.9507
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1435 - acc: 0.9559
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1311 - acc: 0.9587
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1221 - acc: 0.9620
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1121 - acc: 0.9651
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1033 - acc: 0.9671
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0985 - acc: 0.9689
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0953 - acc: 0.9697
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0864 - acc: 0.9719
('\nTraining time for model (n_proj=', '12', ', size_proj=', '16', '): --- 1020.520818 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (12, 10000, 16, 16, 1))
Correctly classified: 9802
Incorrectly classified: 198
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.99       980
           1       0.99      0.99      0.99      1135
           2       0.98      0.98      0.98      1032
           3       0.98      0.98      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.99      0.98      0.98       892
           6       0.98      0.98      0.98       958
           7       0.98      0.98      0.98      1028
           8       0.97      0.98      0.97       974
           9       0.98      0.97      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (12, 10000, 16, 16, 1))

Adversarial test data.
Correctly classified: 6174
Incorrectly classified: 3826
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.95      0.86      0.90       980
           1       1.00      0.00      0.00      1135
           2       0.70      0.91      0.79      1032
           3       0.71      0.82      0.76      1010
           4       0.68      0.60      0.64       982
           5       0.79      0.70      0.74       892
           6       0.92      0.75      0.83       958
           7       0.95      0.49      0.64      1028
           8       0.27      0.91      0.42       974
           9       0.68      0.25      0.36      1009

   micro avg       0.62      0.62      0.62     10000
   macro avg       0.77      0.63      0.61     10000
weighted avg       0.77      0.62      0.60     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (12, 60000, 20, 20, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 30ms/step - loss: 0.4836 - acc: 0.8492
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.2003 - acc: 0.9402
Epoch 3/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1531 - acc: 0.9551
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1259 - acc: 0.9617
Epoch 5/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1080 - acc: 0.9666
Epoch 6/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0946 - acc: 0.9699
Epoch 7/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0867 - acc: 0.9725
Epoch 8/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0794 - acc: 0.9752
Epoch 9/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0744 - acc: 0.9767
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0682 - acc: 0.9778
Epoch 11/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0682 - acc: 0.9785
Epoch 12/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0590 - acc: 0.9822
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 30ms/step - loss: 0.4908 - acc: 0.8477
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1993 - acc: 0.9408
Epoch 3/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1500 - acc: 0.9545
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1256 - acc: 0.9624
Epoch 5/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1112 - acc: 0.9656
Epoch 6/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0947 - acc: 0.9702
Epoch 7/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0860 - acc: 0.9729
Epoch 8/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0791 - acc: 0.9743
Epoch 9/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0708 - acc: 0.9770
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0686 - acc: 0.9782
Epoch 11/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0628 - acc: 0.9798
Epoch 12/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0590 - acc: 0.9817
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 31ms/step - loss: 0.4935 - acc: 0.8471
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.2047 - acc: 0.9384
Epoch 3/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1567 - acc: 0.9538
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1304 - acc: 0.9610
Epoch 5/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1111 - acc: 0.9664
Epoch 6/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1030 - acc: 0.9685
Epoch 7/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0921 - acc: 0.9709
Epoch 8/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0849 - acc: 0.9732
Epoch 9/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0776 - acc: 0.9752
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0699 - acc: 0.9780
Epoch 11/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0688 - acc: 0.9780
Epoch 12/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0647 - acc: 0.9795
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 15s 31ms/step - loss: 0.5005 - acc: 0.8440
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.2033 - acc: 0.9397
Epoch 3/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1504 - acc: 0.9540
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1320 - acc: 0.9593
Epoch 5/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1096 - acc: 0.9651
Epoch 6/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0984 - acc: 0.9699
Epoch 7/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0882 - acc: 0.9725
Epoch 8/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0805 - acc: 0.9741
Epoch 9/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0730 - acc: 0.9768
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0692 - acc: 0.9776
Epoch 11/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0653 - acc: 0.9797
Epoch 12/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0600 - acc: 0.9813
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 15s 31ms/step - loss: 0.4746 - acc: 0.8516
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1940 - acc: 0.9412
Epoch 3/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1532 - acc: 0.9533
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1267 - acc: 0.9617
Epoch 5/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1048 - acc: 0.9679
Epoch 6/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0939 - acc: 0.9712
Epoch 7/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0858 - acc: 0.9736
Epoch 8/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0743 - acc: 0.9766
Epoch 9/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0717 - acc: 0.9771
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0696 - acc: 0.9781
Epoch 11/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0637 - acc: 0.9798
Epoch 12/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0564 - acc: 0.9823
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 15s 32ms/step - loss: 0.4778 - acc: 0.8523
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1959 - acc: 0.9415
Epoch 3/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1541 - acc: 0.9523
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1265 - acc: 0.9612
Epoch 5/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1067 - acc: 0.9672
Epoch 6/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0994 - acc: 0.9694
Epoch 7/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0904 - acc: 0.9712
Epoch 8/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0821 - acc: 0.9735
Epoch 9/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0742 - acc: 0.9771
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0713 - acc: 0.9775
Epoch 11/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0665 - acc: 0.9794
Epoch 12/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0583 - acc: 0.9805
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 15s 32ms/step - loss: 0.4873 - acc: 0.8485
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.2037 - acc: 0.9401
Epoch 3/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1577 - acc: 0.9525
Epoch 4/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1282 - acc: 0.9610
Epoch 5/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1102 - acc: 0.9650
Epoch 6/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0998 - acc: 0.9689
Epoch 7/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0927 - acc: 0.9716
Epoch 8/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0819 - acc: 0.9745
Epoch 9/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0790 - acc: 0.9756
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0699 - acc: 0.9774
Epoch 11/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0664 - acc: 0.9784
Epoch 12/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0635 - acc: 0.9800
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 15s 32ms/step - loss: 0.5004 - acc: 0.8423
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1957 - acc: 0.9417
Epoch 3/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1497 - acc: 0.9549
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1197 - acc: 0.9632
Epoch 5/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1081 - acc: 0.9674
Epoch 6/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0960 - acc: 0.9695
Epoch 7/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0873 - acc: 0.9723
Epoch 8/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0751 - acc: 0.9749
Epoch 9/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0684 - acc: 0.9780
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0678 - acc: 0.9779
Epoch 11/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0632 - acc: 0.9797
Epoch 12/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0566 - acc: 0.9814
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 15s 33ms/step - loss: 0.4721 - acc: 0.8543
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1974 - acc: 0.9410
Epoch 3/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1452 - acc: 0.9560
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1224 - acc: 0.9629
Epoch 5/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1045 - acc: 0.9683
Epoch 6/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1001 - acc: 0.9688
Epoch 7/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0884 - acc: 0.9729
Epoch 8/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0799 - acc: 0.9747
Epoch 9/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0713 - acc: 0.9775
Epoch 10/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0651 - acc: 0.9796
Epoch 11/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0629 - acc: 0.9797
Epoch 12/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0567 - acc: 0.9815
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 16s 33ms/step - loss: 0.5018 - acc: 0.8452
Epoch 2/12

469/468 [==============================] - 10s 22ms/step - loss: 0.2061 - acc: 0.9397
Epoch 3/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1610 - acc: 0.9511
Epoch 4/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1289 - acc: 0.9606
Epoch 5/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1153 - acc: 0.9649
Epoch 6/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1019 - acc: 0.9687
Epoch 7/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0894 - acc: 0.9724
Epoch 8/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0863 - acc: 0.9733
Epoch 9/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0761 - acc: 0.9758
Epoch 10/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0742 - acc: 0.9760
Epoch 11/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0662 - acc: 0.9782
Epoch 12/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0626 - acc: 0.9796
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 16s 34ms/step - loss: 0.5087 - acc: 0.8425
Epoch 2/12

469/468 [==============================] - 11s 22ms/step - loss: 0.2073 - acc: 0.9371
Epoch 3/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1613 - acc: 0.9513
Epoch 4/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1328 - acc: 0.9592
Epoch 5/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1128 - acc: 0.9645
Epoch 6/12

469/468 [==============================] - 11s 22ms/step - loss: 0.0999 - acc: 0.9696
Epoch 7/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0921 - acc: 0.9714
Epoch 8/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0860 - acc: 0.9732
Epoch 9/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0795 - acc: 0.9745
Epoch 10/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0742 - acc: 0.9764
Epoch 11/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0700 - acc: 0.9781
Epoch 12/12

469/468 [==============================] - 11s 22ms/step - loss: 0.0611 - acc: 0.9802
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 16s 34ms/step - loss: 0.4764 - acc: 0.8514
Epoch 2/12

469/468 [==============================] - 11s 22ms/step - loss: 0.1963 - acc: 0.9419
Epoch 3/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1531 - acc: 0.9533
Epoch 4/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1268 - acc: 0.9618
Epoch 5/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1111 - acc: 0.9654
Epoch 6/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0971 - acc: 0.9698
Epoch 7/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0859 - acc: 0.9727
Epoch 8/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0791 - acc: 0.9745
Epoch 9/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0741 - acc: 0.9771
Epoch 10/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0699 - acc: 0.9782
Epoch 11/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0644 - acc: 0.9796
Epoch 12/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0631 - acc: 0.9802
('\nTraining time for model (n_proj=', '12', ', size_proj=', '20', '): --- 1520.01840806 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (12, 10000, 20, 20, 1))
Correctly classified: 9821
Incorrectly classified: 179
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.99       980
           1       0.99      0.99      0.99      1135
           2       0.98      0.98      0.98      1032
           3       0.98      0.98      0.98      1010
           4       0.98      0.99      0.98       982
           5       0.98      0.98      0.98       892
           6       0.99      0.98      0.98       958
           7       0.98      0.97      0.98      1028
           8       0.98      0.98      0.98       974
           9       0.98      0.97      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (12, 10000, 20, 20, 1))

Adversarial test data.
Correctly classified: 5990
Incorrectly classified: 4010
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.96      0.84      0.90       980
           1       1.00      0.00      0.00      1135
           2       0.77      0.86      0.82      1032
           3       0.72      0.83      0.77      1010
           4       0.66      0.61      0.63       982
           5       0.80      0.65      0.72       892
           6       0.93      0.75      0.83       958
           7       0.98      0.44      0.61      1028
           8       0.25      0.94      0.39       974
           9       0.66      0.16      0.26      1009

   micro avg       0.60      0.60      0.60     10000
   macro avg       0.77      0.61      0.59     10000
weighted avg       0.78      0.60      0.58     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (15, 60000, 8, 8, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 18ms/step - loss: 0.8239 - acc: 0.7356
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4730 - acc: 0.8524
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4072 - acc: 0.8733
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3638 - acc: 0.8869
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3312 - acc: 0.8975
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3204 - acc: 0.9004
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3024 - acc: 0.9045
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2927 - acc: 0.9089
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2739 - acc: 0.9142
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2730 - acc: 0.9161
Epoch 11/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2643 - acc: 0.9172
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2630 - acc: 0.9170
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 19ms/step - loss: 0.8354 - acc: 0.7267
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4843 - acc: 0.8473
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4018 - acc: 0.8744
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3647 - acc: 0.8861
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3406 - acc: 0.8938
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3180 - acc: 0.9003
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3045 - acc: 0.9048
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2845 - acc: 0.9091
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2808 - acc: 0.9107
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2698 - acc: 0.9149
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2587 - acc: 0.9179
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2566 - acc: 0.9189
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 19ms/step - loss: 0.8276 - acc: 0.7333
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4726 - acc: 0.8537
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4002 - acc: 0.8750
Epoch 4/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3531 - acc: 0.8912
Epoch 5/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3325 - acc: 0.8959
Epoch 6/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3130 - acc: 0.9022
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2910 - acc: 0.9093
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2777 - acc: 0.9122
Epoch 9/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2721 - acc: 0.9140
Epoch 10/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2657 - acc: 0.9178
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2593 - acc: 0.9189
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2558 - acc: 0.9207
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 19ms/step - loss: 0.8638 - acc: 0.7193
Epoch 2/12

469/468 [==============================] - 3s 5ms/step - loss: 0.4737 - acc: 0.8530
Epoch 3/12

469/468 [==============================] - 3s 5ms/step - loss: 0.4045 - acc: 0.8740
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3656 - acc: 0.8861
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3413 - acc: 0.8934
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3197 - acc: 0.9000
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3051 - acc: 0.9047
Epoch 8/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2911 - acc: 0.9087
Epoch 9/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2816 - acc: 0.9118
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2714 - acc: 0.9153
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2701 - acc: 0.9147
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2545 - acc: 0.9189
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 19ms/step - loss: 0.8277 - acc: 0.7350
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4747 - acc: 0.8510
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4113 - acc: 0.8720
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3678 - acc: 0.8845
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3364 - acc: 0.8957
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3196 - acc: 0.9007
Epoch 7/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2963 - acc: 0.9082
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2894 - acc: 0.9101
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2751 - acc: 0.9141
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2694 - acc: 0.9152
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2628 - acc: 0.9177
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2533 - acc: 0.9203
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 20ms/step - loss: 0.8711 - acc: 0.7115
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.5034 - acc: 0.8401
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4224 - acc: 0.8668
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3806 - acc: 0.8805
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3602 - acc: 0.8868
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3423 - acc: 0.8917
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3197 - acc: 0.8997
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3076 - acc: 0.9046
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2897 - acc: 0.9079
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2869 - acc: 0.9101
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2862 - acc: 0.9093
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2718 - acc: 0.9152
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 20ms/step - loss: 0.8235 - acc: 0.7363
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4616 - acc: 0.8574
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3898 - acc: 0.8806
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3605 - acc: 0.8899
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3322 - acc: 0.8966
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3092 - acc: 0.9030
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2896 - acc: 0.9102
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2788 - acc: 0.9135
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2655 - acc: 0.9179
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2563 - acc: 0.9204
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2539 - acc: 0.9215
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2467 - acc: 0.9229
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 20ms/step - loss: 0.7931 - acc: 0.7463
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4383 - acc: 0.8634
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3711 - acc: 0.8849
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3422 - acc: 0.8942
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3144 - acc: 0.9029
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2960 - acc: 0.9092
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2776 - acc: 0.9129
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2608 - acc: 0.9192
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2550 - acc: 0.9213
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2504 - acc: 0.9231
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2451 - acc: 0.9233
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2320 - acc: 0.9283
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 21ms/step - loss: 0.8317 - acc: 0.7308
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4565 - acc: 0.8576
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3816 - acc: 0.8835
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3533 - acc: 0.8915
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3252 - acc: 0.8998
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3046 - acc: 0.9064
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2816 - acc: 0.9113
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2742 - acc: 0.9142
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2665 - acc: 0.9163
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2579 - acc: 0.9199
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2506 - acc: 0.9217
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2423 - acc: 0.9241
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 21ms/step - loss: 0.7864 - acc: 0.7453
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4507 - acc: 0.8574
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3803 - acc: 0.8813
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3490 - acc: 0.8915
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3246 - acc: 0.8981
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2988 - acc: 0.9074
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2891 - acc: 0.9096
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2817 - acc: 0.9117
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2664 - acc: 0.9171
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2606 - acc: 0.9192
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2527 - acc: 0.9225
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2471 - acc: 0.9235
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 21ms/step - loss: 0.8085 - acc: 0.7382
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4663 - acc: 0.8551
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3921 - acc: 0.8786
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3569 - acc: 0.8896
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3271 - acc: 0.8989
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3065 - acc: 0.9052
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2940 - acc: 0.9090
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2754 - acc: 0.9135
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2674 - acc: 0.9166
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2554 - acc: 0.9208
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2531 - acc: 0.9205
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2461 - acc: 0.9236
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 21ms/step - loss: 0.7866 - acc: 0.7494
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4486 - acc: 0.8612
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3720 - acc: 0.8850
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3428 - acc: 0.8954
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3155 - acc: 0.9030
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2903 - acc: 0.9098
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2803 - acc: 0.9132
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2727 - acc: 0.9148
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2651 - acc: 0.9183
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2540 - acc: 0.9209
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2500 - acc: 0.9224
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2318 - acc: 0.9291
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 22ms/step - loss: 0.8347 - acc: 0.7253
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4657 - acc: 0.8539
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3924 - acc: 0.8768
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3551 - acc: 0.8912
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3297 - acc: 0.8979
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3123 - acc: 0.9036
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2930 - acc: 0.9086
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2836 - acc: 0.9105
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2734 - acc: 0.9159
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2592 - acc: 0.9189
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2532 - acc: 0.9211
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2496 - acc: 0.9232
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 22ms/step - loss: 0.8113 - acc: 0.7380
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4544 - acc: 0.8571
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3897 - acc: 0.8783
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3579 - acc: 0.8887
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3321 - acc: 0.8962
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3113 - acc: 0.9045
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2957 - acc: 0.9076
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2873 - acc: 0.9112
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2757 - acc: 0.9147
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2667 - acc: 0.9179
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2599 - acc: 0.9189
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2488 - acc: 0.9221
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 11s 22ms/step - loss: 0.8263 - acc: 0.7309
Epoch 2/12

469/468 [==============================] - 3s 6ms/step - loss: 0.4650 - acc: 0.8541
Epoch 3/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3896 - acc: 0.8792
Epoch 4/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3587 - acc: 0.8876
Epoch 5/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3309 - acc: 0.8956
Epoch 6/12

469/468 [==============================] - 3s 6ms/step - loss: 0.3118 - acc: 0.9013
Epoch 7/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2933 - acc: 0.9060
Epoch 8/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2803 - acc: 0.9109
Epoch 9/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2749 - acc: 0.9133
Epoch 10/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2583 - acc: 0.9185
Epoch 11/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2577 - acc: 0.9199
Epoch 12/12

469/468 [==============================] - 3s 6ms/step - loss: 0.2518 - acc: 0.9200
('\nTraining time for model (n_proj=', '15', ', size_proj=', '8', '): --- 591.027954102 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (15, 10000, 8, 8, 1))
Correctly classified: 9692
Incorrectly classified: 308
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.97      0.99      0.98       980
           1       0.99      0.99      0.99      1135
           2       0.96      0.97      0.96      1032
           3       0.96      0.97      0.96      1010
           4       0.96      0.97      0.97       982
           5       0.98      0.97      0.97       892
           6       0.98      0.97      0.97       958
           7       0.97      0.96      0.97      1028
           8       0.96      0.96      0.96       974
           9       0.97      0.94      0.95      1009

   micro avg       0.97      0.97      0.97     10000
   macro avg       0.97      0.97      0.97     10000
weighted avg       0.97      0.97      0.97     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (15, 10000, 8, 8, 1))

Adversarial test data.
Correctly classified: 5861
Incorrectly classified: 4139
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.94      0.81      0.87       980
           1       1.00      0.00      0.01      1135
           2       0.48      0.93      0.63      1032
           3       0.65      0.81      0.72      1010
           4       0.61      0.66      0.63       982
           5       0.80      0.62      0.70       892
           6       0.94      0.71      0.81       958
           7       0.94      0.43      0.59      1028
           8       0.30      0.85      0.45       974
           9       0.62      0.15      0.24      1009

   micro avg       0.59      0.59      0.59     10000
   macro avg       0.73      0.60      0.56     10000
weighted avg       0.73      0.59      0.55     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (15, 60000, 12, 12, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 27ms/step - loss: 0.6366 - acc: 0.7986
Epoch 2/12

469/468 [==============================] - 4s 10ms/step - loss: 0.3088 - acc: 0.9046
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2620 - acc: 0.9209
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2248 - acc: 0.9301
Epoch 5/12

469/468 [==============================] - 4s 10ms/step - loss: 0.2029 - acc: 0.9374
Epoch 6/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1946 - acc: 0.9393
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1745 - acc: 0.9458
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1635 - acc: 0.9488
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1563 - acc: 0.9522
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1496 - acc: 0.9537
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1451 - acc: 0.9539
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1354 - acc: 0.9565
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 27ms/step - loss: 0.6215 - acc: 0.8042
Epoch 2/12

469/468 [==============================] - 4s 10ms/step - loss: 0.3158 - acc: 0.9029
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2488 - acc: 0.9225
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2231 - acc: 0.9305
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2037 - acc: 0.9367
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1883 - acc: 0.9409
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1764 - acc: 0.9452
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1671 - acc: 0.9476
Epoch 9/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1553 - acc: 0.9512
Epoch 10/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1483 - acc: 0.9536
Epoch 11/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1463 - acc: 0.9540
Epoch 12/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1409 - acc: 0.9552
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 28ms/step - loss: 0.6161 - acc: 0.8036
Epoch 2/12

469/468 [==============================] - 4s 10ms/step - loss: 0.3083 - acc: 0.9055
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2554 - acc: 0.9210
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2239 - acc: 0.9320
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2020 - acc: 0.9366
Epoch 6/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1863 - acc: 0.9412
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1753 - acc: 0.9450
Epoch 8/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1645 - acc: 0.9482
Epoch 9/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1511 - acc: 0.9525
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1494 - acc: 0.9530
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1388 - acc: 0.9566
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1375 - acc: 0.9563
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 28ms/step - loss: 0.6489 - acc: 0.7953
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3122 - acc: 0.9029
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2594 - acc: 0.9201
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2304 - acc: 0.9283
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2100 - acc: 0.9347
Epoch 6/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1895 - acc: 0.9404
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1798 - acc: 0.9436
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1717 - acc: 0.9451
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1652 - acc: 0.9483
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1550 - acc: 0.9506
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1511 - acc: 0.9525
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1413 - acc: 0.9556
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 29ms/step - loss: 0.6426 - acc: 0.7942
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3158 - acc: 0.9039
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2571 - acc: 0.9215
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2235 - acc: 0.9311
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2098 - acc: 0.9355
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1943 - acc: 0.9408
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1748 - acc: 0.9460
Epoch 8/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1727 - acc: 0.9455
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1575 - acc: 0.9503
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1551 - acc: 0.9508
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1485 - acc: 0.9534
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1396 - acc: 0.9552
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 29ms/step - loss: 0.6415 - acc: 0.7946
Epoch 2/12

469/468 [==============================] - 4s 10ms/step - loss: 0.3129 - acc: 0.9030
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2576 - acc: 0.9216
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2234 - acc: 0.9316
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2059 - acc: 0.9365
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1852 - acc: 0.9413
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1787 - acc: 0.9438
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1652 - acc: 0.9483
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1547 - acc: 0.9517
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1524 - acc: 0.9512
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1424 - acc: 0.9536
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1398 - acc: 0.9557
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 29ms/step - loss: 0.6262 - acc: 0.8022
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3072 - acc: 0.9074
Epoch 3/12

469/468 [==============================] - 4s 10ms/step - loss: 0.2526 - acc: 0.9230
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2196 - acc: 0.9324
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1969 - acc: 0.9389
Epoch 6/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1813 - acc: 0.9433
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1731 - acc: 0.9462
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1652 - acc: 0.9490
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1561 - acc: 0.9513
Epoch 10/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1478 - acc: 0.9541
Epoch 11/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1418 - acc: 0.9542
Epoch 12/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1366 - acc: 0.9566
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 30ms/step - loss: 0.6296 - acc: 0.7999
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3115 - acc: 0.9057
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2572 - acc: 0.9214
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2251 - acc: 0.9311
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2026 - acc: 0.9376
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1890 - acc: 0.9410
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1742 - acc: 0.9463
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1640 - acc: 0.9498
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1597 - acc: 0.9501
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1528 - acc: 0.9536
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1417 - acc: 0.9548
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1356 - acc: 0.9576
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 30ms/step - loss: 0.6162 - acc: 0.8068
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3032 - acc: 0.9085
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2570 - acc: 0.9223
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2263 - acc: 0.9301
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2042 - acc: 0.9366
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1869 - acc: 0.9422
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1797 - acc: 0.9450
Epoch 8/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1622 - acc: 0.9490
Epoch 9/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1591 - acc: 0.9497
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1527 - acc: 0.9528
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1459 - acc: 0.9538
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1378 - acc: 0.9581
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 30ms/step - loss: 0.6556 - acc: 0.7908
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3154 - acc: 0.9034
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2635 - acc: 0.9185
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2303 - acc: 0.9307
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2052 - acc: 0.9372
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1854 - acc: 0.9426
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1829 - acc: 0.9434
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1701 - acc: 0.9455
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1605 - acc: 0.9499
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1503 - acc: 0.9527
Epoch 11/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1483 - acc: 0.9538
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1407 - acc: 0.9544
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 30ms/step - loss: 0.6143 - acc: 0.8052
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3067 - acc: 0.9061
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2613 - acc: 0.9201
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2260 - acc: 0.9308
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2097 - acc: 0.9358
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1934 - acc: 0.9398
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1754 - acc: 0.9446
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1713 - acc: 0.9472
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1569 - acc: 0.9503
Epoch 10/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1498 - acc: 0.9527
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1469 - acc: 0.9534
Epoch 12/12

469/468 [==============================] - 4s 10ms/step - loss: 0.1403 - acc: 0.9564
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 31ms/step - loss: 0.6363 - acc: 0.7997
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3172 - acc: 0.9038
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2578 - acc: 0.9205
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2295 - acc: 0.9301
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2002 - acc: 0.9378
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1901 - acc: 0.9413
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1739 - acc: 0.9466
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1708 - acc: 0.9461
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1572 - acc: 0.9513
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1481 - acc: 0.9536
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1392 - acc: 0.9571
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1376 - acc: 0.9562
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 15s 31ms/step - loss: 0.6477 - acc: 0.7948
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3187 - acc: 0.9025
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2584 - acc: 0.9214
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2203 - acc: 0.9315
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2045 - acc: 0.9361
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1914 - acc: 0.9410
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1733 - acc: 0.9459
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1725 - acc: 0.9463
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1536 - acc: 0.9519
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1536 - acc: 0.9520
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1418 - acc: 0.9552
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1356 - acc: 0.9571
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 15s 32ms/step - loss: 0.6264 - acc: 0.8014
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3091 - acc: 0.9050
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2564 - acc: 0.9211
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2209 - acc: 0.9321
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2035 - acc: 0.9371
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1875 - acc: 0.9400
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1717 - acc: 0.9461
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1701 - acc: 0.9477
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1505 - acc: 0.9524
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1492 - acc: 0.9533
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1413 - acc: 0.9564
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1384 - acc: 0.9564
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 15s 32ms/step - loss: 0.6263 - acc: 0.8006
Epoch 2/12

469/468 [==============================] - 5s 10ms/step - loss: 0.3149 - acc: 0.9041
Epoch 3/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2510 - acc: 0.9244
Epoch 4/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2179 - acc: 0.9320
Epoch 5/12

469/468 [==============================] - 5s 10ms/step - loss: 0.2023 - acc: 0.9377
Epoch 6/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1871 - acc: 0.9409
Epoch 7/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1730 - acc: 0.9458
Epoch 8/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1619 - acc: 0.9484
Epoch 9/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1536 - acc: 0.9520
Epoch 10/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1473 - acc: 0.9542
Epoch 11/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1446 - acc: 0.9549
Epoch 12/12

469/468 [==============================] - 5s 10ms/step - loss: 0.1374 - acc: 0.9568
('\nTraining time for model (n_proj=', '15', ', size_proj=', '12', '): --- 972.89905715 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (15, 10000, 12, 12, 1))
Correctly classified: 9774
Incorrectly classified: 226
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.98       980
           1       0.99      0.99      0.99      1135
           2       0.97      0.98      0.97      1032
           3       0.98      0.98      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.99      0.97      0.98       892
           6       0.98      0.98      0.98       958
           7       0.98      0.97      0.97      1028
           8       0.96      0.97      0.97       974
           9       0.98      0.96      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (15, 10000, 12, 12, 1))

Adversarial test data.
Correctly classified: 6072
Incorrectly classified: 3928
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.96      0.80      0.87       980
           1       1.00      0.01      0.03      1135
           2       0.60      0.93      0.73      1032
           3       0.74      0.78      0.76      1010
           4       0.65      0.61      0.63       982
           5       0.74      0.70      0.72       892
           6       0.91      0.79      0.84       958
           7       0.96      0.49      0.65      1028
           8       0.28      0.90      0.42       974
           9       0.65      0.17      0.27      1009

   micro avg       0.61      0.61      0.61     10000
   macro avg       0.75      0.62      0.59     10000
weighted avg       0.75      0.61      0.58     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (15, 60000, 16, 16, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 18s 38ms/step - loss: 0.5211 - acc: 0.8368
Epoch 2/12

469/468 [==============================] - 7s 16ms/step - loss: 0.2309 - acc: 0.9306
Epoch 3/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1825 - acc: 0.9436
Epoch 4/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1555 - acc: 0.9528
Epoch 5/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1419 - acc: 0.9560
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1260 - acc: 0.9612
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1179 - acc: 0.9634
Epoch 8/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1081 - acc: 0.9666
Epoch 9/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1022 - acc: 0.9676
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0926 - acc: 0.9704
Epoch 11/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0899 - acc: 0.9714
Epoch 12/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0858 - acc: 0.9726
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 18s 39ms/step - loss: 0.5308 - acc: 0.8353
Epoch 2/12

469/468 [==============================] - 7s 16ms/step - loss: 0.2358 - acc: 0.9293
Epoch 3/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1882 - acc: 0.9428
Epoch 4/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1642 - acc: 0.9505
Epoch 5/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1408 - acc: 0.9555
Epoch 6/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1288 - acc: 0.9594
Epoch 7/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1178 - acc: 0.9629
Epoch 8/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1083 - acc: 0.9662
Epoch 9/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0996 - acc: 0.9680
Epoch 10/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0925 - acc: 0.9706
Epoch 11/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0926 - acc: 0.9707
Epoch 12/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0868 - acc: 0.9731
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 19s 40ms/step - loss: 0.5251 - acc: 0.8353
Epoch 2/12

469/468 [==============================] - 7s 16ms/step - loss: 0.2333 - acc: 0.9303
Epoch 3/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1861 - acc: 0.9441
Epoch 4/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1549 - acc: 0.9523
Epoch 5/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1417 - acc: 0.9567
Epoch 6/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1307 - acc: 0.9593
Epoch 7/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1178 - acc: 0.9629
Epoch 8/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1100 - acc: 0.9662
Epoch 9/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1057 - acc: 0.9673
Epoch 10/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0985 - acc: 0.9688
Epoch 11/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0932 - acc: 0.9694
Epoch 12/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0857 - acc: 0.9719
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 19s 40ms/step - loss: 0.5409 - acc: 0.8308
Epoch 2/12

469/468 [==============================] - 7s 16ms/step - loss: 0.2391 - acc: 0.9283
Epoch 3/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1863 - acc: 0.9421
Epoch 4/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1648 - acc: 0.9501
Epoch 5/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1434 - acc: 0.9562
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1271 - acc: 0.9596
Epoch 7/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1168 - acc: 0.9626
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1085 - acc: 0.9665
Epoch 9/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1068 - acc: 0.9658
Epoch 10/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0989 - acc: 0.9684
Epoch 11/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0908 - acc: 0.9714
Epoch 12/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0903 - acc: 0.9711
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 19s 40ms/step - loss: 0.5505 - acc: 0.8265
Epoch 2/12

469/468 [==============================] - 8s 16ms/step - loss: 0.2428 - acc: 0.9264
Epoch 3/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1935 - acc: 0.9410
Epoch 4/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1654 - acc: 0.9497
Epoch 5/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1480 - acc: 0.9541
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1272 - acc: 0.9607
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1223 - acc: 0.9612
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1090 - acc: 0.9658
Epoch 9/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1016 - acc: 0.9673
Epoch 10/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0977 - acc: 0.9684
Epoch 11/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0889 - acc: 0.9711
Epoch 12/12

469/468 [==============================] - 7s 16ms/step - loss: 0.0888 - acc: 0.9723
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 19s 41ms/step - loss: 0.5490 - acc: 0.8279
Epoch 2/12

469/468 [==============================] - 8s 16ms/step - loss: 0.2464 - acc: 0.9260
Epoch 3/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1940 - acc: 0.9407
Epoch 4/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1702 - acc: 0.9482
Epoch 5/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1515 - acc: 0.9536
Epoch 6/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1352 - acc: 0.9584
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1250 - acc: 0.9611
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1142 - acc: 0.9642
Epoch 9/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1079 - acc: 0.9654
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1006 - acc: 0.9681
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0973 - acc: 0.9686
Epoch 12/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0950 - acc: 0.9706
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 19s 41ms/step - loss: 0.5391 - acc: 0.8314
Epoch 2/12

469/468 [==============================] - 8s 16ms/step - loss: 0.2403 - acc: 0.9276
Epoch 3/12

469/468 [==============================] - 7s 16ms/step - loss: 0.1926 - acc: 0.9417
Epoch 4/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1559 - acc: 0.9528
Epoch 5/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1412 - acc: 0.9566
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1303 - acc: 0.9602
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1166 - acc: 0.9636
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1094 - acc: 0.9651
Epoch 9/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1051 - acc: 0.9672
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0959 - acc: 0.9692
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0923 - acc: 0.9714
Epoch 12/12

469/468 [==============================] - 8s 17ms/step - loss: 0.0870 - acc: 0.9721
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 20s 42ms/step - loss: 0.5294 - acc: 0.8334
Epoch 2/12

469/468 [==============================] - 8s 16ms/step - loss: 0.2287 - acc: 0.9305
Epoch 3/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1844 - acc: 0.9435
Epoch 4/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1609 - acc: 0.9506
Epoch 5/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1410 - acc: 0.9571
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1267 - acc: 0.9604
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1153 - acc: 0.9641
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1114 - acc: 0.9653
Epoch 9/12

469/468 [==============================] - 8s 17ms/step - loss: 0.0984 - acc: 0.9684
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0929 - acc: 0.9702
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0859 - acc: 0.9725
Epoch 12/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0829 - acc: 0.9746
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 20s 43ms/step - loss: 0.5301 - acc: 0.8351
Epoch 2/12

469/468 [==============================] - 8s 16ms/step - loss: 0.2359 - acc: 0.9290
Epoch 3/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1894 - acc: 0.9419
Epoch 4/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1577 - acc: 0.9518
Epoch 5/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1409 - acc: 0.9559
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1306 - acc: 0.9593
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1182 - acc: 0.9625
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1064 - acc: 0.9659
Epoch 9/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1001 - acc: 0.9691
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0936 - acc: 0.9698
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0890 - acc: 0.9713
Epoch 12/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0879 - acc: 0.9720
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 21s 44ms/step - loss: 0.5305 - acc: 0.8339
Epoch 2/12

469/468 [==============================] - 8s 16ms/step - loss: 0.2391 - acc: 0.9268
Epoch 3/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1813 - acc: 0.9456
Epoch 4/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1559 - acc: 0.9523
Epoch 5/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1369 - acc: 0.9587
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1245 - acc: 0.9612
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1154 - acc: 0.9646
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1042 - acc: 0.9676
Epoch 9/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1031 - acc: 0.9679
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0936 - acc: 0.9703
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0913 - acc: 0.9704
Epoch 12/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0834 - acc: 0.9737
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 20s 44ms/step - loss: 0.5233 - acc: 0.8372
Epoch 2/12

469/468 [==============================] - 8s 17ms/step - loss: 0.2410 - acc: 0.9280
Epoch 3/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1887 - acc: 0.9432
Epoch 4/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1613 - acc: 0.9505
Epoch 5/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1430 - acc: 0.9561
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1320 - acc: 0.9583
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1215 - acc: 0.9623
Epoch 8/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1153 - acc: 0.9636
Epoch 9/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1045 - acc: 0.9669
Epoch 10/12

469/468 [==============================] - 8s 17ms/step - loss: 0.0965 - acc: 0.9695
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0890 - acc: 0.9716
Epoch 12/12

469/468 [==============================] - 8s 17ms/step - loss: 0.0892 - acc: 0.9723
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 21s 44ms/step - loss: 0.5285 - acc: 0.8344
Epoch 2/12

469/468 [==============================] - 8s 17ms/step - loss: 0.2290 - acc: 0.9308
Epoch 3/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1876 - acc: 0.9440
Epoch 4/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1630 - acc: 0.9498
Epoch 5/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1408 - acc: 0.9562
Epoch 6/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1302 - acc: 0.9589
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1186 - acc: 0.9633
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1103 - acc: 0.9652
Epoch 9/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1016 - acc: 0.9682
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0997 - acc: 0.9692
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0918 - acc: 0.9702
Epoch 12/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0870 - acc: 0.9720
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 21s 44ms/step - loss: 0.5317 - acc: 0.8318
Epoch 2/12

469/468 [==============================] - 8s 16ms/step - loss: 0.2338 - acc: 0.9291
Epoch 3/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1833 - acc: 0.9429
Epoch 4/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1633 - acc: 0.9498
Epoch 5/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1419 - acc: 0.9558
Epoch 6/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1274 - acc: 0.9603
Epoch 7/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1218 - acc: 0.9620
Epoch 8/12

469/468 [==============================] - 8s 17ms/step - loss: 0.1096 - acc: 0.9652
Epoch 9/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1121 - acc: 0.9666
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0993 - acc: 0.9698
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0921 - acc: 0.9705
Epoch 12/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0890 - acc: 0.9716
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 20s 44ms/step - loss: 0.5390 - acc: 0.8284
Epoch 2/12

469/468 [==============================] - 8s 16ms/step - loss: 0.2424 - acc: 0.9278
Epoch 3/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1930 - acc: 0.9411
Epoch 4/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1643 - acc: 0.9493
Epoch 5/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1388 - acc: 0.9570
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1325 - acc: 0.9596
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1243 - acc: 0.9607
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1085 - acc: 0.9664
Epoch 9/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1044 - acc: 0.9679
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0991 - acc: 0.9691
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0914 - acc: 0.9717
Epoch 12/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0861 - acc: 0.9728
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 21s 44ms/step - loss: 0.5196 - acc: 0.8363
Epoch 2/12

469/468 [==============================] - 8s 16ms/step - loss: 0.2331 - acc: 0.9285
Epoch 3/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1831 - acc: 0.9447
Epoch 4/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1578 - acc: 0.9512
Epoch 5/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1416 - acc: 0.9570
Epoch 6/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1282 - acc: 0.9599
Epoch 7/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1162 - acc: 0.9631
Epoch 8/12

469/468 [==============================] - 8s 16ms/step - loss: 0.1091 - acc: 0.9653
Epoch 9/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0977 - acc: 0.9689
Epoch 10/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0934 - acc: 0.9712
Epoch 11/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0902 - acc: 0.9716
Epoch 12/12

469/468 [==============================] - 8s 16ms/step - loss: 0.0851 - acc: 0.9727
('\nTraining time for model (n_proj=', '15', ', size_proj=', '16', '): --- 1562.45664001 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (15, 10000, 16, 16, 1))
Correctly classified: 9820
Incorrectly classified: 180
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.99       980
           1       0.99      0.99      0.99      1135
           2       0.98      0.98      0.98      1032
           3       0.98      0.98      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.99      0.98      0.98       892
           6       0.98      0.98      0.98       958
           7       0.98      0.98      0.98      1028
           8       0.97      0.98      0.98       974
           9       0.98      0.97      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (15, 10000, 16, 16, 1))

Adversarial test data.
Correctly classified: 6201
Incorrectly classified: 3799
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.97      0.85      0.91       980
           1       1.00      0.00      0.01      1135
           2       0.71      0.90      0.79      1032
           3       0.74      0.81      0.77      1010
           4       0.65      0.63      0.64       982
           5       0.79      0.71      0.74       892
           6       0.95      0.78      0.86       958
           7       0.95      0.54      0.69      1028
           8       0.27      0.92      0.41       974
           9       0.68      0.17      0.27      1009

   micro avg       0.62      0.62      0.62     10000
   macro avg       0.77      0.63      0.61     10000
weighted avg       0.77      0.62      0.60     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (15, 60000, 20, 20, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 25s 53ms/step - loss: 0.4668 - acc: 0.8573
Epoch 2/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1916 - acc: 0.9421
Epoch 3/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1448 - acc: 0.9560
Epoch 4/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1219 - acc: 0.9628
Epoch 5/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1053 - acc: 0.9671
Epoch 6/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0927 - acc: 0.9712
Epoch 7/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0846 - acc: 0.9739
Epoch 8/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0737 - acc: 0.9765
Epoch 9/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0694 - acc: 0.9781
Epoch 10/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0644 - acc: 0.9795
Epoch 11/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0600 - acc: 0.9804
Epoch 12/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0577 - acc: 0.9814
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 25s 53ms/step - loss: 0.4914 - acc: 0.8493
Epoch 2/12

469/468 [==============================] - 11s 24ms/step - loss: 0.2051 - acc: 0.9382
Epoch 3/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1544 - acc: 0.9524
Epoch 4/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1302 - acc: 0.9608
Epoch 5/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1103 - acc: 0.9662
Epoch 6/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0951 - acc: 0.9704
Epoch 7/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0876 - acc: 0.9730
Epoch 8/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0819 - acc: 0.9752
Epoch 9/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0757 - acc: 0.9763
Epoch 10/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0659 - acc: 0.9789
Epoch 11/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0651 - acc: 0.9789
Epoch 12/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0618 - acc: 0.9804
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 25s 54ms/step - loss: 0.5139 - acc: 0.8393
Epoch 2/12

469/468 [==============================] - 11s 24ms/step - loss: 0.2071 - acc: 0.9373
Epoch 3/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1557 - acc: 0.9534
Epoch 4/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1283 - acc: 0.9601
Epoch 5/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1105 - acc: 0.9660
Epoch 6/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0985 - acc: 0.9693
Epoch 7/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0897 - acc: 0.9717
Epoch 8/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0845 - acc: 0.9744
Epoch 9/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0773 - acc: 0.9760
Epoch 10/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0700 - acc: 0.9787
Epoch 11/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0658 - acc: 0.9787
Epoch 12/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0615 - acc: 0.9798
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 25s 54ms/step - loss: 0.5026 - acc: 0.8440
Epoch 2/12

469/468 [==============================] - 11s 24ms/step - loss: 0.2031 - acc: 0.9384
Epoch 3/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1556 - acc: 0.9527
Epoch 4/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1301 - acc: 0.9606
Epoch 5/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1119 - acc: 0.9655
Epoch 6/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0995 - acc: 0.9690
Epoch 7/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0942 - acc: 0.9704
Epoch 8/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0850 - acc: 0.9739
Epoch 9/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0786 - acc: 0.9759
Epoch 10/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0716 - acc: 0.9772
Epoch 11/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0642 - acc: 0.9796
Epoch 12/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0628 - acc: 0.9799
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 25s 54ms/step - loss: 0.4803 - acc: 0.8521
Epoch 2/12

469/468 [==============================] - 11s 24ms/step - loss: 0.2016 - acc: 0.9385
Epoch 3/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1487 - acc: 0.9542
Epoch 4/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1289 - acc: 0.9598
Epoch 5/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1104 - acc: 0.9658
Epoch 6/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1020 - acc: 0.9687
Epoch 7/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0905 - acc: 0.9721
Epoch 8/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0783 - acc: 0.9753
Epoch 9/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0753 - acc: 0.9763
Epoch 10/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0673 - acc: 0.9780
Epoch 11/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0633 - acc: 0.9800
Epoch 12/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0621 - acc: 0.9799
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 26s 54ms/step - loss: 0.4919 - acc: 0.8462
Epoch 2/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1987 - acc: 0.9406
Epoch 3/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1541 - acc: 0.9533
Epoch 4/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1324 - acc: 0.9601
Epoch 5/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1100 - acc: 0.9662
Epoch 6/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1006 - acc: 0.9694
Epoch 7/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0881 - acc: 0.9720
Epoch 8/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0819 - acc: 0.9749
Epoch 9/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0757 - acc: 0.9766
Epoch 10/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0697 - acc: 0.9779
Epoch 11/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0685 - acc: 0.9785
Epoch 12/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0606 - acc: 0.9806
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 26s 56ms/step - loss: 0.4855 - acc: 0.8500
Epoch 2/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1944 - acc: 0.9421
Epoch 3/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1526 - acc: 0.9547
Epoch 4/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1283 - acc: 0.9615
Epoch 5/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1117 - acc: 0.9654
Epoch 6/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1011 - acc: 0.9695
Epoch 7/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0873 - acc: 0.9728
Epoch 8/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0815 - acc: 0.9744
Epoch 9/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0742 - acc: 0.9772
Epoch 10/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0683 - acc: 0.9783
Epoch 11/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0666 - acc: 0.9799
Epoch 12/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0623 - acc: 0.9799
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 26s 56ms/step - loss: 0.4844 - acc: 0.8486
Epoch 2/12

469/468 [==============================] - 12s 25ms/step - loss: 0.2007 - acc: 0.9401
Epoch 3/12

469/468 [==============================] - 11s 25ms/step - loss: 0.1506 - acc: 0.9547
Epoch 4/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1227 - acc: 0.9622
Epoch 5/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1067 - acc: 0.9674
Epoch 6/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0927 - acc: 0.9710
Epoch 7/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0884 - acc: 0.9725
Epoch 8/12

469/468 [==============================] - 11s 25ms/step - loss: 0.0820 - acc: 0.9744
Epoch 9/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0759 - acc: 0.9756
Epoch 10/12

469/468 [==============================] - 11s 24ms/step - loss: 0.0686 - acc: 0.9781
Epoch 11/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0646 - acc: 0.9793
Epoch 12/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0616 - acc: 0.9799
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 26s 56ms/step - loss: 0.4861 - acc: 0.8484
Epoch 2/12

469/468 [==============================] - 11s 25ms/step - loss: 0.1950 - acc: 0.9408
Epoch 3/12

469/468 [==============================] - 11s 24ms/step - loss: 0.1489 - acc: 0.9545
Epoch 4/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1295 - acc: 0.9599
Epoch 5/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1106 - acc: 0.9663
Epoch 6/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0980 - acc: 0.9684
Epoch 7/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0899 - acc: 0.9723
Epoch 8/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0817 - acc: 0.9734
Epoch 9/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0739 - acc: 0.9764
Epoch 10/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0665 - acc: 0.9789
Epoch 11/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0646 - acc: 0.9792
Epoch 12/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0596 - acc: 0.9806
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 27s 57ms/step - loss: 0.4897 - acc: 0.8488
Epoch 2/12

469/468 [==============================] - 12s 25ms/step - loss: 0.2017 - acc: 0.9401
Epoch 3/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1531 - acc: 0.9538
Epoch 4/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1228 - acc: 0.9631
Epoch 5/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1135 - acc: 0.9647
Epoch 6/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0978 - acc: 0.9689
Epoch 7/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0921 - acc: 0.9712
Epoch 8/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0802 - acc: 0.9743
Epoch 9/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0795 - acc: 0.9744
Epoch 10/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0719 - acc: 0.9776
Epoch 11/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0656 - acc: 0.9787
Epoch 12/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0611 - acc: 0.9805
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 27s 57ms/step - loss: 0.5037 - acc: 0.8430
Epoch 2/12

469/468 [==============================] - 12s 25ms/step - loss: 0.2023 - acc: 0.9404
Epoch 3/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1552 - acc: 0.9527
Epoch 4/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1281 - acc: 0.9601
Epoch 5/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1126 - acc: 0.9650
Epoch 6/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1025 - acc: 0.9693
Epoch 7/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0922 - acc: 0.9715
Epoch 8/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0813 - acc: 0.9741
Epoch 9/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0743 - acc: 0.9763
Epoch 10/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0696 - acc: 0.9777
Epoch 11/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0636 - acc: 0.9800
Epoch 12/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0613 - acc: 0.9806
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 27s 58ms/step - loss: 0.4836 - acc: 0.8484
Epoch 2/12

469/468 [==============================] - 12s 25ms/step - loss: 0.2025 - acc: 0.9394
Epoch 3/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1537 - acc: 0.9539
Epoch 4/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1276 - acc: 0.9621
Epoch 5/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1116 - acc: 0.9660
Epoch 6/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1008 - acc: 0.9686
Epoch 7/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0860 - acc: 0.9734
Epoch 8/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0830 - acc: 0.9742
Epoch 9/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0737 - acc: 0.9768
Epoch 10/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0664 - acc: 0.9781
Epoch 11/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0658 - acc: 0.9793
Epoch 12/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0601 - acc: 0.9809
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 27s 58ms/step - loss: 0.5020 - acc: 0.8432
Epoch 2/12

469/468 [==============================] - 12s 25ms/step - loss: 0.2051 - acc: 0.9386
Epoch 3/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1570 - acc: 0.9530
Epoch 4/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1292 - acc: 0.9608
Epoch 5/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1138 - acc: 0.9660
Epoch 6/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1017 - acc: 0.9692
Epoch 7/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0898 - acc: 0.9714
Epoch 8/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0794 - acc: 0.9750
Epoch 9/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0746 - acc: 0.9757
Epoch 10/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0714 - acc: 0.9772
Epoch 11/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0663 - acc: 0.9795
Epoch 12/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0610 - acc: 0.9796
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 27s 58ms/step - loss: 0.4981 - acc: 0.8460
Epoch 2/12

469/468 [==============================] - 12s 25ms/step - loss: 0.2054 - acc: 0.9386
Epoch 3/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1613 - acc: 0.9515
Epoch 4/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1311 - acc: 0.9605
Epoch 5/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1151 - acc: 0.9651
Epoch 6/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1026 - acc: 0.9688
Epoch 7/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0924 - acc: 0.9718
Epoch 8/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0829 - acc: 0.9731
Epoch 9/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0759 - acc: 0.9759
Epoch 10/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0715 - acc: 0.9770
Epoch 11/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0696 - acc: 0.9781
Epoch 12/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0620 - acc: 0.9798
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 28s 59ms/step - loss: 0.4889 - acc: 0.8458
Epoch 2/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1959 - acc: 0.9405
Epoch 3/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1544 - acc: 0.9536
Epoch 4/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1281 - acc: 0.9612
Epoch 5/12

469/468 [==============================] - 12s 25ms/step - loss: 0.1120 - acc: 0.9657
Epoch 6/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0968 - acc: 0.9707
Epoch 7/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0862 - acc: 0.9740
Epoch 8/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0773 - acc: 0.9757
Epoch 9/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0717 - acc: 0.9774
Epoch 10/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0693 - acc: 0.9787
Epoch 11/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0639 - acc: 0.9802
Epoch 12/12

469/468 [==============================] - 12s 25ms/step - loss: 0.0597 - acc: 0.9812
('\nTraining time for model (n_proj=', '15', ', size_proj=', '20', '): --- 2310.75436187 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (15, 10000, 20, 20, 1))
Correctly classified: 9822
Incorrectly classified: 178
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.99       980
           1       0.99      0.99      0.99      1135
           2       0.98      0.98      0.98      1032
           3       0.98      0.99      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.99      0.98      0.98       892
           6       0.98      0.98      0.98       958
           7       0.98      0.98      0.98      1028
           8       0.98      0.98      0.98       974
           9       0.98      0.97      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (15, 10000, 20, 20, 1))

Adversarial test data.
Correctly classified: 6122
Incorrectly classified: 3878
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.96      0.85      0.90       980
           1       1.00      0.00      0.00      1135
           2       0.77      0.87      0.82      1032
           3       0.70      0.85      0.77      1010
           4       0.67      0.60      0.63       982
           5       0.81      0.66      0.73       892
           6       0.94      0.76      0.84       958
           7       0.96      0.52      0.67      1028
           8       0.26      0.93      0.40       974
           9       0.67      0.18      0.28      1009

   micro avg       0.61      0.61      0.61     10000
   macro avg       0.77      0.62      0.60     10000
weighted avg       0.78      0.61      0.59     10000

