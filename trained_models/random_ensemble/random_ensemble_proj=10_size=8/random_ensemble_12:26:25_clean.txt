
Loading mnist.
('x_train shape:', (60000, 28, 28, 1), '\nx_test shape:', (10000, 28, 28, 1))

Now training

Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (10, 60000, 8, 8, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 5ms/step - loss: 0.8198 - acc: 0.7366
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4708 - acc: 0.8526
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4048 - acc: 0.8742
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3586 - acc: 0.8893
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3243 - acc: 0.9002
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3213 - acc: 0.9008
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2950 - acc: 0.9086
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2833 - acc: 0.9125
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2810 - acc: 0.9123
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2667 - acc: 0.9177
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2600 - acc: 0.9189
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2583 - acc: 0.9198
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 0.8739 - acc: 0.7170
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5379 - acc: 0.8305
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4491 - acc: 0.8594
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4018 - acc: 0.8747
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3810 - acc: 0.8828
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3549 - acc: 0.8885
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3352 - acc: 0.8961
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3207 - acc: 0.9006
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3061 - acc: 0.9037
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2985 - acc: 0.9056
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2850 - acc: 0.9108
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2834 - acc: 0.9108
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 0.9460 - acc: 0.6909
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5662 - acc: 0.8221
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4815 - acc: 0.8501
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4344 - acc: 0.8650
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3947 - acc: 0.8764
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3808 - acc: 0.8819
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3601 - acc: 0.8874
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3427 - acc: 0.8936
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3212 - acc: 0.9001
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3139 - acc: 0.9022
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3068 - acc: 0.9047
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2981 - acc: 0.9069
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 1.0550 - acc: 0.6577
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.6158 - acc: 0.8053
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5231 - acc: 0.8380
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4673 - acc: 0.8553
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4256 - acc: 0.8673
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3918 - acc: 0.8770
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3710 - acc: 0.8851
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3645 - acc: 0.8863
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3469 - acc: 0.8912
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3344 - acc: 0.8947
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3206 - acc: 0.8995
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3095 - acc: 0.9024
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 1.0354 - acc: 0.6638
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.6288 - acc: 0.8037
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5322 - acc: 0.8353
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4781 - acc: 0.8517
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4378 - acc: 0.8658
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4158 - acc: 0.8715
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3936 - acc: 0.8805
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3704 - acc: 0.8843
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3665 - acc: 0.8866
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3502 - acc: 0.8920
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3417 - acc: 0.8957
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3343 - acc: 0.8978
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 1.1632 - acc: 0.6089
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.7025 - acc: 0.7757
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5985 - acc: 0.8107
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5366 - acc: 0.8305
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4902 - acc: 0.8455
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4532 - acc: 0.8567
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4275 - acc: 0.8646
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4047 - acc: 0.8713
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3922 - acc: 0.8785
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3779 - acc: 0.8804
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3678 - acc: 0.8836
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3568 - acc: 0.8882
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 1.0391 - acc: 0.6598
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.6317 - acc: 0.8018
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5351 - acc: 0.8346
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4805 - acc: 0.8510
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4343 - acc: 0.8642
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4083 - acc: 0.8728
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3948 - acc: 0.8782
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3748 - acc: 0.8835
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3619 - acc: 0.8870
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3381 - acc: 0.8956
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3374 - acc: 0.8942
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3276 - acc: 0.8996
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 1.0376 - acc: 0.6546
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.6425 - acc: 0.7974
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5318 - acc: 0.8341
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4764 - acc: 0.8530
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4389 - acc: 0.8629
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4078 - acc: 0.8749
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3815 - acc: 0.8815
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3699 - acc: 0.8862
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3632 - acc: 0.8886
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3477 - acc: 0.8930
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3364 - acc: 0.8964
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3257 - acc: 0.9010
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 1.0609 - acc: 0.6497
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.6588 - acc: 0.7927
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5538 - acc: 0.8282
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4909 - acc: 0.8473
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4576 - acc: 0.8565
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4251 - acc: 0.8675
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4079 - acc: 0.8750
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3889 - acc: 0.8797
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3684 - acc: 0.8867
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3578 - acc: 0.8894
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3479 - acc: 0.8927
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3395 - acc: 0.8955
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 1.0397 - acc: 0.6610
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.6485 - acc: 0.7954
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5617 - acc: 0.8239
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5072 - acc: 0.8411
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4649 - acc: 0.8547
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4437 - acc: 0.8632
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4165 - acc: 0.8714
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3967 - acc: 0.8737
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3871 - acc: 0.8794
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3635 - acc: 0.8876
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3559 - acc: 0.8892
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3493 - acc: 0.8923
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (10, 10000, 8, 8, 1))

Original test data.
Correctly classified: 3069
Incorrectly classified: 6931
Test accuracy: 0.00%
('\nAdversarial evaluation using', 'fgsm', 'method.')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (10, 10000, 8, 8, 1))

Adversarial test data.
Correctly classified: 1535
Incorrectly classified: 8465
Adversarial accuracy: 0.00%

Loading new
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (10, 10000, 8, 8, 1))

Original test data.
Correctly classified: 3473
Incorrectly classified: 6527
Test accuracy: 0.00%
('\nAdversarial evaluation using', 'fgsm', 'method.')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (10, 10000, 8, 8, 1))

Adversarial test data.
Correctly classified: 1794
Incorrectly classified: 8206
Adversarial accuracy: 0.00%

Loading old
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (10, 10000, 8, 8, 1))

Original test data.
Correctly classified: 1745
Incorrectly classified: 8255
Test accuracy: 0.00%
('\nAdversarial evaluation using', 'fgsm', 'method.')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (10, 10000, 8, 8, 1))

Adversarial test data.
Correctly classified: 1268
Incorrectly classified: 8732
Adversarial accuracy: 0.00%
