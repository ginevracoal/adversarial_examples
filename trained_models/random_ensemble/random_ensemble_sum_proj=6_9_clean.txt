
Loading mnist.
('x_train shape:', (60000, 28, 28, 1), '\nx_test shape:', (10000, 28, 28, 1))

Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (6, 60000, 8, 8, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 0.8320 - acc: 0.7321
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4647 - acc: 0.8558
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4026 - acc: 0.8759
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3603 - acc: 0.8881
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3381 - acc: 0.8949
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3171 - acc: 0.9015
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2997 - acc: 0.9074
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2913 - acc: 0.9087
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2762 - acc: 0.9132
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2691 - acc: 0.9157
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2593 - acc: 0.9183
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2551 - acc: 0.9199
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 2s 5ms/step - loss: 0.8250 - acc: 0.7317
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4699 - acc: 0.8528
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4006 - acc: 0.8755
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3668 - acc: 0.8861
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3370 - acc: 0.8948
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3189 - acc: 0.8995
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3068 - acc: 0.9045
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2907 - acc: 0.9077
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2857 - acc: 0.9100
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2744 - acc: 0.9148
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2676 - acc: 0.9160
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2590 - acc: 0.9184
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 5ms/step - loss: 0.8397 - acc: 0.7287
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4708 - acc: 0.8544
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3987 - acc: 0.8750
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3707 - acc: 0.8873
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3367 - acc: 0.8947
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3215 - acc: 0.8989
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3004 - acc: 0.9065
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2920 - acc: 0.9087
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2747 - acc: 0.9133
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2699 - acc: 0.9150
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2595 - acc: 0.9190
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2510 - acc: 0.9216
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 6ms/step - loss: 0.8487 - acc: 0.7286
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4735 - acc: 0.8539
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3977 - acc: 0.8755
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3622 - acc: 0.8874
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3320 - acc: 0.8961
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3095 - acc: 0.9052
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2988 - acc: 0.9059
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2860 - acc: 0.9102
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2750 - acc: 0.9139
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2692 - acc: 0.9146
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2610 - acc: 0.9186
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2527 - acc: 0.9207
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 6ms/step - loss: 0.8338 - acc: 0.7334
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4762 - acc: 0.8509
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4023 - acc: 0.8748
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3678 - acc: 0.8854
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3434 - acc: 0.8933
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3243 - acc: 0.8971
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2964 - acc: 0.9078
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2941 - acc: 0.9098
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2901 - acc: 0.9109
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2740 - acc: 0.9142
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2609 - acc: 0.9165
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2577 - acc: 0.9189
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 3s 6ms/step - loss: 0.8699 - acc: 0.7135
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4956 - acc: 0.8438
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4314 - acc: 0.8656
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3770 - acc: 0.8815
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3554 - acc: 0.8889
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3384 - acc: 0.8938
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3212 - acc: 0.8987
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3044 - acc: 0.9037
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2974 - acc: 0.9069
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2884 - acc: 0.9096
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2799 - acc: 0.9118
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2711 - acc: 0.9137
('\nTraining time for model (n_proj=', 6, ', size_proj=', 8, '): --- 165.151494026 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (6, 10000, 8, 8, 1))
Correctly classified: 9666
Incorrectly classified: 334
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.97      0.99      0.98       980
           1       0.98      0.99      0.99      1135
           2       0.97      0.95      0.96      1032
           3       0.96      0.97      0.96      1010
           4       0.96      0.97      0.97       982
           5       0.97      0.96      0.96       892
           6       0.97      0.98      0.98       958
           7       0.97      0.95      0.96      1028
           8       0.95      0.96      0.95       974
           9       0.96      0.94      0.95      1009

   micro avg       0.97      0.97      0.97     10000
   macro avg       0.97      0.97      0.97     10000
weighted avg       0.97      0.97      0.97     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (6, 10000, 8, 8, 1))

Adversarial test data.
Correctly classified: 5539
Incorrectly classified: 4461
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.85      0.78      0.81       980
           1       1.00      0.01      0.01      1135
           2       0.63      0.77      0.69      1032
           3       0.46      0.78      0.58      1010
           4       0.67      0.49      0.57       982
           5       0.58      0.68      0.63       892
           6       0.76      0.75      0.76       958
           7       0.89      0.34      0.49      1028
           8       0.30      0.81      0.44       974
           9       0.55      0.22      0.31      1009

   micro avg       0.55      0.55      0.55     10000
   macro avg       0.67      0.56      0.53     10000
weighted avg       0.68      0.55      0.52     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (6, 60000, 12, 12, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 5s 10ms/step - loss: 0.6154 - acc: 0.8042
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3067 - acc: 0.9068
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2528 - acc: 0.9227
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2220 - acc: 0.9326
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2089 - acc: 0.9361
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1929 - acc: 0.9399
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1808 - acc: 0.9439
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1652 - acc: 0.9487
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1595 - acc: 0.9505
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1499 - acc: 0.9521
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1451 - acc: 0.9539
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1388 - acc: 0.9566
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 5s 10ms/step - loss: 0.6181 - acc: 0.8054
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3095 - acc: 0.9045
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2510 - acc: 0.9227
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2234 - acc: 0.9317
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1978 - acc: 0.9388
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1850 - acc: 0.9422
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1739 - acc: 0.9460
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1624 - acc: 0.9500
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1529 - acc: 0.9526
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1470 - acc: 0.9536
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1403 - acc: 0.9556
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1371 - acc: 0.9566
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 5s 10ms/step - loss: 0.6247 - acc: 0.8026
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3120 - acc: 0.9049
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2543 - acc: 0.9204
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2237 - acc: 0.9308
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2048 - acc: 0.9348
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1879 - acc: 0.9416
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1806 - acc: 0.9440
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1701 - acc: 0.9468
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1586 - acc: 0.9502
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1521 - acc: 0.9524
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1481 - acc: 0.9531
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1382 - acc: 0.9561
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 5s 10ms/step - loss: 0.6577 - acc: 0.7908
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3190 - acc: 0.9020
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2654 - acc: 0.9188
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2230 - acc: 0.9307
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2089 - acc: 0.9363
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1917 - acc: 0.9410
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1836 - acc: 0.9426
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1760 - acc: 0.9453
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1593 - acc: 0.9507
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1579 - acc: 0.9499
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1438 - acc: 0.9541
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1443 - acc: 0.9549
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 5s 11ms/step - loss: 0.6265 - acc: 0.8020
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3189 - acc: 0.9010
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2580 - acc: 0.9197
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2298 - acc: 0.9290
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2080 - acc: 0.9348
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1867 - acc: 0.9413
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1781 - acc: 0.9438
Epoch 8/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1611 - acc: 0.9494
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1548 - acc: 0.9513
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1541 - acc: 0.9513
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1466 - acc: 0.9534
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1370 - acc: 0.9568
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 5s 11ms/step - loss: 0.6230 - acc: 0.8014
Epoch 2/12

469/468 [==============================] - 4s 8ms/step - loss: 0.3141 - acc: 0.9034
Epoch 3/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2513 - acc: 0.9227
Epoch 4/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2301 - acc: 0.9290
Epoch 5/12

469/468 [==============================] - 4s 8ms/step - loss: 0.2077 - acc: 0.9354
Epoch 6/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1935 - acc: 0.9390
Epoch 7/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1743 - acc: 0.9457
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1703 - acc: 0.9467
Epoch 9/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1566 - acc: 0.9505
Epoch 10/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1524 - acc: 0.9520
Epoch 11/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1436 - acc: 0.9539
Epoch 12/12

469/468 [==============================] - 4s 8ms/step - loss: 0.1374 - acc: 0.9567
('\nTraining time for model (n_proj=', 6, ', size_proj=', 12, '): --- 292.957458019 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (6, 10000, 12, 12, 1))
Correctly classified: 9774
Incorrectly classified: 226
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.97      0.99      0.98       980
           1       0.99      0.99      0.99      1135
           2       0.98      0.97      0.98      1032
           3       0.97      0.98      0.97      1010
           4       0.97      0.97      0.97       982
           5       0.98      0.97      0.98       892
           6       0.98      0.98      0.98       958
           7       0.97      0.97      0.97      1028
           8       0.98      0.97      0.97       974
           9       0.97      0.97      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (6, 10000, 12, 12, 1))

Adversarial test data.
Correctly classified: 6065
Incorrectly classified: 3935
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.94      0.77      0.84       980
           1       0.96      0.02      0.05      1135
           2       0.61      0.87      0.71      1032
           3       0.60      0.81      0.69      1010
           4       0.68      0.60      0.64       982
           5       0.70      0.66      0.68       892
           6       0.88      0.71      0.79       958
           7       0.90      0.51      0.65      1028
           8       0.31      0.87      0.46       974
           9       0.64      0.34      0.44      1009

   micro avg       0.61      0.61      0.61     10000
   macro avg       0.72      0.62      0.59     10000
weighted avg       0.73      0.61      0.59     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (6, 60000, 16, 16, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 8s 17ms/step - loss: 0.5267 - acc: 0.8333
Epoch 2/12

469/468 [==============================] - 6s 14ms/step - loss: 0.2284 - acc: 0.9299
Epoch 3/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1871 - acc: 0.9430
Epoch 4/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1561 - acc: 0.9523
Epoch 5/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1416 - acc: 0.9560
Epoch 6/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1278 - acc: 0.9612
Epoch 7/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1156 - acc: 0.9642
Epoch 8/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1094 - acc: 0.9657
Epoch 9/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1022 - acc: 0.9681
Epoch 10/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0961 - acc: 0.9694
Epoch 11/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0881 - acc: 0.9716
Epoch 12/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0839 - acc: 0.9724
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 8s 17ms/step - loss: 0.5277 - acc: 0.8359
Epoch 2/12

469/468 [==============================] - 6s 14ms/step - loss: 0.2361 - acc: 0.9278
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1857 - acc: 0.9440
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1602 - acc: 0.9518
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1365 - acc: 0.9577
Epoch 6/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1286 - acc: 0.9602
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1179 - acc: 0.9628
Epoch 8/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1093 - acc: 0.9660
Epoch 9/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1022 - acc: 0.9677
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0974 - acc: 0.9686
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0909 - acc: 0.9704
Epoch 12/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0882 - acc: 0.9715
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 8s 17ms/step - loss: 0.5350 - acc: 0.8316
Epoch 2/12

469/468 [==============================] - 6s 14ms/step - loss: 0.2397 - acc: 0.9272
Epoch 3/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1841 - acc: 0.9443
Epoch 4/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1602 - acc: 0.9518
Epoch 5/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1387 - acc: 0.9577
Epoch 6/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1297 - acc: 0.9593
Epoch 7/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1176 - acc: 0.9635
Epoch 8/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1085 - acc: 0.9659
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1032 - acc: 0.9672
Epoch 10/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0981 - acc: 0.9684
Epoch 11/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0898 - acc: 0.9715
Epoch 12/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0852 - acc: 0.9726
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 8s 18ms/step - loss: 0.5446 - acc: 0.8299
Epoch 2/12

469/468 [==============================] - 6s 14ms/step - loss: 0.2366 - acc: 0.9277
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1909 - acc: 0.9415
Epoch 4/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1634 - acc: 0.9492
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1428 - acc: 0.9555
Epoch 6/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1338 - acc: 0.9581
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1207 - acc: 0.9627
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1173 - acc: 0.9630
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1075 - acc: 0.9654
Epoch 10/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0995 - acc: 0.9691
Epoch 11/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0930 - acc: 0.9703
Epoch 12/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0903 - acc: 0.9708
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 8s 18ms/step - loss: 0.5274 - acc: 0.8335
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2411 - acc: 0.9271
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1846 - acc: 0.9434
Epoch 4/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1597 - acc: 0.9507
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1431 - acc: 0.9548
Epoch 6/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1270 - acc: 0.9597
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1185 - acc: 0.9624
Epoch 8/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1094 - acc: 0.9655
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1012 - acc: 0.9681
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1004 - acc: 0.9684
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0887 - acc: 0.9716
Epoch 12/12

469/468 [==============================] - 6s 14ms/step - loss: 0.0847 - acc: 0.9727
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 8s 18ms/step - loss: 0.5511 - acc: 0.8268
Epoch 2/12

469/468 [==============================] - 7s 14ms/step - loss: 0.2420 - acc: 0.9269
Epoch 3/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1917 - acc: 0.9423
Epoch 4/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1624 - acc: 0.9497
Epoch 5/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1469 - acc: 0.9548
Epoch 6/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1329 - acc: 0.9580
Epoch 7/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1180 - acc: 0.9634
Epoch 8/12

469/468 [==============================] - 6s 14ms/step - loss: 0.1136 - acc: 0.9641
Epoch 9/12

469/468 [==============================] - 7s 14ms/step - loss: 0.1039 - acc: 0.9668
Epoch 10/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0993 - acc: 0.9693
Epoch 11/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0914 - acc: 0.9703
Epoch 12/12

469/468 [==============================] - 7s 14ms/step - loss: 0.0895 - acc: 0.9710
('\nTraining time for model (n_proj=', 6, ', size_proj=', 16, '): --- 484.45188117 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (6, 10000, 16, 16, 1))
Correctly classified: 9807
Incorrectly classified: 193
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.99       980
           1       0.99      0.99      0.99      1135
           2       0.97      0.98      0.98      1032
           3       0.98      0.99      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.99      0.98      0.98       892
           6       0.98      0.98      0.98       958
           7       0.98      0.97      0.98      1028
           8       0.97      0.98      0.97       974
           9       0.98      0.96      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (6, 10000, 16, 16, 1))

Adversarial test data.
Correctly classified: 5967
Incorrectly classified: 4033
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.95      0.81      0.88       980
           1       1.00      0.01      0.01      1135
           2       0.68      0.87      0.77      1032
           3       0.68      0.83      0.75      1010
           4       0.65      0.58      0.61       982
           5       0.78      0.63      0.69       892
           6       0.89      0.75      0.82       958
           7       0.93      0.46      0.61      1028
           8       0.26      0.91      0.41       974
           9       0.64      0.22      0.33      1009

   micro avg       0.60      0.60      0.60     10000
   macro avg       0.75      0.61      0.59     10000
weighted avg       0.75      0.60      0.58     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (6, 60000, 20, 20, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 12s 25ms/step - loss: 0.4939 - acc: 0.8466
Epoch 2/12

469/468 [==============================] - 9s 20ms/step - loss: 0.2007 - acc: 0.9409
Epoch 3/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1499 - acc: 0.9554
Epoch 4/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1259 - acc: 0.9625
Epoch 5/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1116 - acc: 0.9653
Epoch 6/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0946 - acc: 0.9713
Epoch 7/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0875 - acc: 0.9724
Epoch 8/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0796 - acc: 0.9754
Epoch 9/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0694 - acc: 0.9778
Epoch 10/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0635 - acc: 0.9793
Epoch 11/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0595 - acc: 0.9808
Epoch 12/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0569 - acc: 0.9814
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 12s 25ms/step - loss: 0.4891 - acc: 0.8475
Epoch 2/12

469/468 [==============================] - 9s 20ms/step - loss: 0.2034 - acc: 0.9394
Epoch 3/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1514 - acc: 0.9541
Epoch 4/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1304 - acc: 0.9599
Epoch 5/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1109 - acc: 0.9659
Epoch 6/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0996 - acc: 0.9691
Epoch 7/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0888 - acc: 0.9720
Epoch 8/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0836 - acc: 0.9742
Epoch 9/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0769 - acc: 0.9757
Epoch 10/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0701 - acc: 0.9772
Epoch 11/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0642 - acc: 0.9798
Epoch 12/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0592 - acc: 0.9806
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 12s 25ms/step - loss: 0.5146 - acc: 0.8400
Epoch 2/12

469/468 [==============================] - 9s 20ms/step - loss: 0.2039 - acc: 0.9389
Epoch 3/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1565 - acc: 0.9528
Epoch 4/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1330 - acc: 0.9591
Epoch 5/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1100 - acc: 0.9661
Epoch 6/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1007 - acc: 0.9682
Epoch 7/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0944 - acc: 0.9706
Epoch 8/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0849 - acc: 0.9732
Epoch 9/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0763 - acc: 0.9753
Epoch 10/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0729 - acc: 0.9763
Epoch 11/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0661 - acc: 0.9789
Epoch 12/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0672 - acc: 0.9789
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 12s 26ms/step - loss: 0.4927 - acc: 0.8478
Epoch 2/12

469/468 [==============================] - 10s 20ms/step - loss: 0.2059 - acc: 0.9390
Epoch 3/12

469/468 [==============================] - 10s 20ms/step - loss: 0.1577 - acc: 0.9527
Epoch 4/12

469/468 [==============================] - 9s 20ms/step - loss: 0.1337 - acc: 0.9597
Epoch 5/12

469/468 [==============================] - 10s 20ms/step - loss: 0.1110 - acc: 0.9666
Epoch 6/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0992 - acc: 0.9694
Epoch 7/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0916 - acc: 0.9711
Epoch 8/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0852 - acc: 0.9730
Epoch 9/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0778 - acc: 0.9751
Epoch 10/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0711 - acc: 0.9777
Epoch 11/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0681 - acc: 0.9790
Epoch 12/12

469/468 [==============================] - 9s 20ms/step - loss: 0.0598 - acc: 0.9803
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 12s 26ms/step - loss: 0.4981 - acc: 0.8459
Epoch 2/12

469/468 [==============================] - 10s 21ms/step - loss: 0.2052 - acc: 0.9389
Epoch 3/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1537 - acc: 0.9533
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1279 - acc: 0.9610
Epoch 5/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1118 - acc: 0.9654
Epoch 6/12

469/468 [==============================] - 10s 20ms/step - loss: 0.1033 - acc: 0.9681
Epoch 7/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0918 - acc: 0.9712
Epoch 8/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0843 - acc: 0.9737
Epoch 9/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0755 - acc: 0.9765
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0672 - acc: 0.9785
Epoch 11/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0620 - acc: 0.9802
Epoch 12/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0622 - acc: 0.9798
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 12s 26ms/step - loss: 0.5080 - acc: 0.8426
Epoch 2/12

469/468 [==============================] - 10s 20ms/step - loss: 0.1984 - acc: 0.9412
Epoch 3/12

469/468 [==============================] - 10s 20ms/step - loss: 0.1586 - acc: 0.9534
Epoch 4/12

469/468 [==============================] - 10s 21ms/step - loss: 0.1306 - acc: 0.9599
Epoch 5/12

469/468 [==============================] - 10s 20ms/step - loss: 0.1093 - acc: 0.9667
Epoch 6/12

469/468 [==============================] - 10s 20ms/step - loss: 0.1013 - acc: 0.9687
Epoch 7/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0911 - acc: 0.9717
Epoch 8/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0828 - acc: 0.9735
Epoch 9/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0749 - acc: 0.9764
Epoch 10/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0677 - acc: 0.9787
Epoch 11/12

469/468 [==============================] - 10s 20ms/step - loss: 0.0650 - acc: 0.9793
Epoch 12/12

469/468 [==============================] - 10s 21ms/step - loss: 0.0594 - acc: 0.9805
('\nTraining time for model (n_proj=', 6, ', size_proj=', 20, '): --- 704.728865862 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (6, 10000, 20, 20, 1))
Correctly classified: 9821
Incorrectly classified: 179
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.99       980
           1       0.99      0.99      0.99      1135
           2       0.98      0.98      0.98      1032
           3       0.98      0.98      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.99      0.98      0.98       892
           6       0.98      0.98      0.98       958
           7       0.98      0.97      0.98      1028
           8       0.98      0.98      0.98       974
           9       0.98      0.97      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (6, 10000, 20, 20, 1))

Adversarial test data.
Correctly classified: 5917
Incorrectly classified: 4083
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.96      0.79      0.87       980
           1       1.00      0.00      0.01      1135
           2       0.70      0.86      0.77      1032
           3       0.65      0.80      0.71      1010
           4       0.67      0.56      0.61       982
           5       0.78      0.61      0.68       892
           6       0.91      0.72      0.80       958
           7       0.94      0.49      0.64      1028
           8       0.26      0.92      0.40       974
           9       0.67      0.27      0.39      1009

   micro avg       0.59      0.59      0.59     10000
   macro avg       0.75      0.60      0.59     10000
weighted avg       0.76      0.59      0.58     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (9, 60000, 8, 8, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 12ms/step - loss: 0.8172 - acc: 0.7390
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4757 - acc: 0.8513
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3988 - acc: 0.8759
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3637 - acc: 0.8882
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3316 - acc: 0.8972
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3196 - acc: 0.9007
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2993 - acc: 0.9075
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2880 - acc: 0.9108
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2836 - acc: 0.9126
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2695 - acc: 0.9153
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2619 - acc: 0.9178
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2517 - acc: 0.9210
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 12ms/step - loss: 0.8427 - acc: 0.7253
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4799 - acc: 0.8496
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3979 - acc: 0.8774
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3715 - acc: 0.8841
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3321 - acc: 0.8964
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3140 - acc: 0.9022
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3053 - acc: 0.9035
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2952 - acc: 0.9082
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2772 - acc: 0.9126
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2741 - acc: 0.9135
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2642 - acc: 0.9172
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2556 - acc: 0.9201
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 12ms/step - loss: 0.8278 - acc: 0.7318
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4675 - acc: 0.8566
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4056 - acc: 0.8754
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3668 - acc: 0.8858
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3401 - acc: 0.8950
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3213 - acc: 0.9003
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3006 - acc: 0.9054
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2846 - acc: 0.9119
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2707 - acc: 0.9150
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2708 - acc: 0.9161
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2649 - acc: 0.9158
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2605 - acc: 0.9194
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 12ms/step - loss: 0.8397 - acc: 0.7299
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4670 - acc: 0.8542
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3971 - acc: 0.8762
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3607 - acc: 0.8872
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3334 - acc: 0.8953
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3173 - acc: 0.9012
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2919 - acc: 0.9086
Epoch 8/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2835 - acc: 0.9102
Epoch 9/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2780 - acc: 0.9125
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2649 - acc: 0.9161
Epoch 11/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2537 - acc: 0.9212
Epoch 12/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2476 - acc: 0.9225
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 13ms/step - loss: 0.8321 - acc: 0.7339
Epoch 2/12

469/468 [==============================] - 3s 5ms/step - loss: 0.4810 - acc: 0.8485
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4067 - acc: 0.8747
Epoch 4/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3596 - acc: 0.8877
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3353 - acc: 0.8958
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3145 - acc: 0.9014
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3037 - acc: 0.9056
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2913 - acc: 0.9093
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2786 - acc: 0.9132
Epoch 10/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2666 - acc: 0.9170
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2619 - acc: 0.9183
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2602 - acc: 0.9180
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 13ms/step - loss: 0.8559 - acc: 0.7153
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.5011 - acc: 0.8440
Epoch 3/12

469/468 [==============================] - 3s 5ms/step - loss: 0.4349 - acc: 0.8637
Epoch 4/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3864 - acc: 0.8786
Epoch 5/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3617 - acc: 0.8856
Epoch 6/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3406 - acc: 0.8923
Epoch 7/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3204 - acc: 0.8982
Epoch 8/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3118 - acc: 0.9031
Epoch 9/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2924 - acc: 0.9078
Epoch 10/12

469/468 [==============================] - 3s 5ms/step - loss: 0.2850 - acc: 0.9098
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2824 - acc: 0.9105
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2737 - acc: 0.9137
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 13ms/step - loss: 0.8239 - acc: 0.7334
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4591 - acc: 0.8566
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3880 - acc: 0.8791
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3464 - acc: 0.8933
Epoch 5/12

469/468 [==============================] - 3s 5ms/step - loss: 0.3301 - acc: 0.8990
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3098 - acc: 0.9037
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2927 - acc: 0.9098
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2771 - acc: 0.9145
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2711 - acc: 0.9157
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2574 - acc: 0.9191
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2481 - acc: 0.9221
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2462 - acc: 0.9231
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 13ms/step - loss: 0.7807 - acc: 0.7488
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4402 - acc: 0.8628
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3762 - acc: 0.8830
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3387 - acc: 0.8949
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3086 - acc: 0.9039
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3027 - acc: 0.9061
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2840 - acc: 0.9112
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2664 - acc: 0.9160
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2554 - acc: 0.9192
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2486 - acc: 0.9219
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2454 - acc: 0.9230
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2350 - acc: 0.9259
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 8, 8, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 6s 14ms/step - loss: 0.8109 - acc: 0.7371
Epoch 2/12

469/468 [==============================] - 2s 5ms/step - loss: 0.4497 - acc: 0.8600
Epoch 3/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3838 - acc: 0.8818
Epoch 4/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3480 - acc: 0.8919
Epoch 5/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3237 - acc: 0.8988
Epoch 6/12

469/468 [==============================] - 2s 5ms/step - loss: 0.3032 - acc: 0.9056
Epoch 7/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2911 - acc: 0.9112
Epoch 8/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2732 - acc: 0.9150
Epoch 9/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2639 - acc: 0.9168
Epoch 10/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2625 - acc: 0.9170
Epoch 11/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2509 - acc: 0.9220
Epoch 12/12

469/468 [==============================] - 2s 5ms/step - loss: 0.2383 - acc: 0.9253
('\nTraining time for model (n_proj=', 9, ', size_proj=', 8, '): --- 305.620163918 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (9, 10000, 8, 8, 1))
Correctly classified: 9690
Incorrectly classified: 310
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.97      0.99      0.98       980
           1       0.98      0.99      0.99      1135
           2       0.97      0.96      0.96      1032
           3       0.97      0.97      0.97      1010
           4       0.96      0.97      0.97       982
           5       0.98      0.97      0.97       892
           6       0.97      0.97      0.97       958
           7       0.97      0.95      0.96      1028
           8       0.96      0.96      0.96       974
           9       0.97      0.94      0.95      1009

   micro avg       0.97      0.97      0.97     10000
   macro avg       0.97      0.97      0.97     10000
weighted avg       0.97      0.97      0.97     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (9, 10000, 8, 8, 1))

Adversarial test data.
Correctly classified: 5880
Incorrectly classified: 4120
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.90      0.83      0.87       980
           1       0.93      0.01      0.02      1135
           2       0.61      0.86      0.72      1032
           3       0.56      0.80      0.66      1010
           4       0.64      0.57      0.60       982
           5       0.65      0.67      0.66       892
           6       0.83      0.77      0.80       958
           7       0.93      0.40      0.56      1028
           8       0.31      0.85      0.45       974
           9       0.58      0.22      0.31      1009

   micro avg       0.59      0.59      0.59     10000
   macro avg       0.69      0.60      0.57     10000
weighted avg       0.70      0.59      0.56     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (9, 60000, 12, 12, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 18ms/step - loss: 0.6264 - acc: 0.8010
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3169 - acc: 0.9033
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2587 - acc: 0.9223
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2307 - acc: 0.9279
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2053 - acc: 0.9368
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1850 - acc: 0.9428
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1753 - acc: 0.9454
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1681 - acc: 0.9477
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1591 - acc: 0.9503
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1501 - acc: 0.9526
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1412 - acc: 0.9550
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1398 - acc: 0.9568
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 18ms/step - loss: 0.6239 - acc: 0.8042
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3077 - acc: 0.9056
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2540 - acc: 0.9220
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2260 - acc: 0.9307
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2027 - acc: 0.9374
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1858 - acc: 0.9426
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1731 - acc: 0.9466
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1660 - acc: 0.9483
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1510 - acc: 0.9521
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1448 - acc: 0.9541
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1418 - acc: 0.9548
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1329 - acc: 0.9569
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 19ms/step - loss: 0.6481 - acc: 0.7939
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3131 - acc: 0.9041
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2567 - acc: 0.9214
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2321 - acc: 0.9287
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2076 - acc: 0.9361
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1912 - acc: 0.9411
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1801 - acc: 0.9434
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1653 - acc: 0.9493
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1555 - acc: 0.9512
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1535 - acc: 0.9520
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1432 - acc: 0.9553
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1403 - acc: 0.9561
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 19ms/step - loss: 0.6420 - acc: 0.7983
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3168 - acc: 0.9025
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2627 - acc: 0.9195
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2270 - acc: 0.9305
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2088 - acc: 0.9350
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1883 - acc: 0.9407
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1757 - acc: 0.9446
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1707 - acc: 0.9467
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1585 - acc: 0.9511
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1514 - acc: 0.9535
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1507 - acc: 0.9515
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1439 - acc: 0.9540
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 19ms/step - loss: 0.6273 - acc: 0.8008
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3182 - acc: 0.9028
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2584 - acc: 0.9194
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2234 - acc: 0.9300
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2065 - acc: 0.9372
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1912 - acc: 0.9404
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1714 - acc: 0.9467
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1685 - acc: 0.9482
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1598 - acc: 0.9496
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1513 - acc: 0.9536
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1472 - acc: 0.9541
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1378 - acc: 0.9562
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 19ms/step - loss: 0.6320 - acc: 0.7978
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3102 - acc: 0.9037
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2608 - acc: 0.9194
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2201 - acc: 0.9320
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2061 - acc: 0.9361
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1922 - acc: 0.9405
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1744 - acc: 0.9457
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1720 - acc: 0.9480
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1572 - acc: 0.9502
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1528 - acc: 0.9511
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1480 - acc: 0.9533
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1359 - acc: 0.9570
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 20ms/step - loss: 0.6174 - acc: 0.8057
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3047 - acc: 0.9069
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2562 - acc: 0.9216
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2229 - acc: 0.9304
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2035 - acc: 0.9368
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1887 - acc: 0.9414
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1752 - acc: 0.9453
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1694 - acc: 0.9472
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1562 - acc: 0.9510
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1524 - acc: 0.9525
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1472 - acc: 0.9549
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1395 - acc: 0.9559
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 9s 20ms/step - loss: 0.6043 - acc: 0.8089
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3079 - acc: 0.9063
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2462 - acc: 0.9245
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2165 - acc: 0.9332
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2009 - acc: 0.9370
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1847 - acc: 0.9434
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1716 - acc: 0.9468
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1604 - acc: 0.9494
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1533 - acc: 0.9517
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1493 - acc: 0.9534
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1409 - acc: 0.9558
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1360 - acc: 0.9567
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 12, 12, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 10s 21ms/step - loss: 0.6145 - acc: 0.8043
Epoch 2/12

469/468 [==============================] - 4s 9ms/step - loss: 0.3005 - acc: 0.9076
Epoch 3/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2434 - acc: 0.9259
Epoch 4/12

469/468 [==============================] - 4s 9ms/step - loss: 0.2216 - acc: 0.9324
Epoch 5/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1938 - acc: 0.9393
Epoch 6/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1866 - acc: 0.9428
Epoch 7/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1782 - acc: 0.9452
Epoch 8/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1592 - acc: 0.9492
Epoch 9/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1587 - acc: 0.9508
Epoch 10/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1472 - acc: 0.9535
Epoch 11/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1402 - acc: 0.9559
Epoch 12/12

469/468 [==============================] - 4s 9ms/step - loss: 0.1393 - acc: 0.9560
('\nTraining time for model (n_proj=', 9, ', size_proj=', 12, '): --- 509.997507095 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (9, 10000, 12, 12, 1))
Correctly classified: 9765
Incorrectly classified: 235
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.98       980
           1       0.99      0.99      0.99      1135
           2       0.97      0.97      0.97      1032
           3       0.98      0.98      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.98      0.98      0.98       892
           6       0.98      0.98      0.98       958
           7       0.98      0.97      0.97      1028
           8       0.96      0.97      0.97       974
           9       0.97      0.96      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (9, 10000, 12, 12, 1))

Adversarial test data.
Correctly classified: 5779
Incorrectly classified: 4221
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.96      0.74      0.84       980
           1       0.90      0.02      0.03      1135
           2       0.69      0.86      0.76      1032
           3       0.65      0.82      0.72      1010
           4       0.68      0.52      0.59       982
           5       0.73      0.68      0.70       892
           6       0.91      0.70      0.79       958
           7       0.94      0.42      0.58      1028
           8       0.26      0.93      0.40       974
           9       0.59      0.20      0.29      1009

   micro avg       0.58      0.58      0.58     10000
   macro avg       0.73      0.59      0.57     10000
weighted avg       0.73      0.58      0.56     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (9, 60000, 16, 16, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 27ms/step - loss: 0.5263 - acc: 0.8328
Epoch 2/12

469/468 [==============================] - 7s 15ms/step - loss: 0.2415 - acc: 0.9271
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1921 - acc: 0.9415
Epoch 4/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1587 - acc: 0.9514
Epoch 5/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1421 - acc: 0.9567
Epoch 6/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1289 - acc: 0.9605
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1182 - acc: 0.9625
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1134 - acc: 0.9634
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1060 - acc: 0.9671
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1012 - acc: 0.9682
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0958 - acc: 0.9696
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0849 - acc: 0.9732
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 27ms/step - loss: 0.5336 - acc: 0.8341
Epoch 2/12

469/468 [==============================] - 7s 15ms/step - loss: 0.2339 - acc: 0.9290
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1873 - acc: 0.9425
Epoch 4/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1600 - acc: 0.9513
Epoch 5/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1437 - acc: 0.9548
Epoch 6/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1270 - acc: 0.9599
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1185 - acc: 0.9630
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1119 - acc: 0.9653
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1007 - acc: 0.9680
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0987 - acc: 0.9688
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0896 - acc: 0.9717
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0844 - acc: 0.9732
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 27ms/step - loss: 0.5345 - acc: 0.8323
Epoch 2/12

469/468 [==============================] - 7s 15ms/step - loss: 0.2358 - acc: 0.9283
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1911 - acc: 0.9421
Epoch 4/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1644 - acc: 0.9491
Epoch 5/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1435 - acc: 0.9555
Epoch 6/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1346 - acc: 0.9586
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1163 - acc: 0.9639
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1097 - acc: 0.9649
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1032 - acc: 0.9668
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0996 - acc: 0.9690
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0924 - acc: 0.9709
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0880 - acc: 0.9723
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 28ms/step - loss: 0.5406 - acc: 0.8324
Epoch 2/12

469/468 [==============================] - 7s 15ms/step - loss: 0.2407 - acc: 0.9282
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1904 - acc: 0.9422
Epoch 4/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1608 - acc: 0.9509
Epoch 5/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1449 - acc: 0.9552
Epoch 6/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1324 - acc: 0.9603
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1213 - acc: 0.9617
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1105 - acc: 0.9657
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1057 - acc: 0.9679
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1009 - acc: 0.9682
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0913 - acc: 0.9711
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0871 - acc: 0.9724
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 28ms/step - loss: 0.5487 - acc: 0.8270
Epoch 2/12

469/468 [==============================] - 7s 15ms/step - loss: 0.2382 - acc: 0.9282
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1832 - acc: 0.9445
Epoch 4/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1627 - acc: 0.9497
Epoch 5/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1449 - acc: 0.9549
Epoch 6/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1333 - acc: 0.9569
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1215 - acc: 0.9622
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1118 - acc: 0.9640
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1064 - acc: 0.9668
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0958 - acc: 0.9699
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0940 - acc: 0.9690
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0909 - acc: 0.9711
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 28ms/step - loss: 0.5391 - acc: 0.8308
Epoch 2/12

469/468 [==============================] - 7s 15ms/step - loss: 0.2431 - acc: 0.9266
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1869 - acc: 0.9426
Epoch 4/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1611 - acc: 0.9506
Epoch 5/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1411 - acc: 0.9559
Epoch 6/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1294 - acc: 0.9595
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1219 - acc: 0.9624
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1146 - acc: 0.9649
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1056 - acc: 0.9665
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1010 - acc: 0.9679
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0929 - acc: 0.9709
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0881 - acc: 0.9717
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 13s 29ms/step - loss: 0.5381 - acc: 0.8350
Epoch 2/12

469/468 [==============================] - 7s 15ms/step - loss: 0.2417 - acc: 0.9264
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1938 - acc: 0.9420
Epoch 4/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1684 - acc: 0.9482
Epoch 5/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1461 - acc: 0.9553
Epoch 6/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1303 - acc: 0.9581
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1212 - acc: 0.9626
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1141 - acc: 0.9644
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1061 - acc: 0.9661
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1016 - acc: 0.9681
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0951 - acc: 0.9701
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0895 - acc: 0.9710
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 29ms/step - loss: 0.5261 - acc: 0.8350
Epoch 2/12

469/468 [==============================] - 7s 15ms/step - loss: 0.2338 - acc: 0.9294
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1921 - acc: 0.9414
Epoch 4/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1654 - acc: 0.9499
Epoch 5/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1404 - acc: 0.9564
Epoch 6/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1281 - acc: 0.9598
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1192 - acc: 0.9623
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1082 - acc: 0.9653
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1053 - acc: 0.9673
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0986 - acc: 0.9688
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0918 - acc: 0.9708
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0858 - acc: 0.9724
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 16, 16, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 14s 29ms/step - loss: 0.5354 - acc: 0.8332
Epoch 2/12

469/468 [==============================] - 7s 15ms/step - loss: 0.2350 - acc: 0.9295
Epoch 3/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1892 - acc: 0.9421
Epoch 4/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1646 - acc: 0.9501
Epoch 5/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1424 - acc: 0.9552
Epoch 6/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1290 - acc: 0.9601
Epoch 7/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1221 - acc: 0.9620
Epoch 8/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1106 - acc: 0.9655
Epoch 9/12

469/468 [==============================] - 7s 15ms/step - loss: 0.1025 - acc: 0.9676
Epoch 10/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0948 - acc: 0.9700
Epoch 11/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0894 - acc: 0.9717
Epoch 12/12

469/468 [==============================] - 7s 15ms/step - loss: 0.0859 - acc: 0.9716
('\nTraining time for model (n_proj=', 9, ', size_proj=', 16, '): --- 826.703104019 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (9, 10000, 16, 16, 1))
Correctly classified: 9807
Incorrectly classified: 193
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.99       980
           1       0.99      0.99      0.99      1135
           2       0.98      0.98      0.98      1032
           3       0.98      0.98      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.99      0.98      0.98       892
           6       0.99      0.98      0.98       958
           7       0.98      0.97      0.98      1028
           8       0.97      0.98      0.97       974
           9       0.98      0.97      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (9, 10000, 16, 16, 1))

Adversarial test data.
Correctly classified: 6044
Incorrectly classified: 3956
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.96      0.83      0.89       980
           1       1.00      0.00      0.01      1135
           2       0.70      0.89      0.78      1032
           3       0.72      0.78      0.75      1010
           4       0.66      0.58      0.62       982
           5       0.75      0.70      0.73       892
           6       0.96      0.70      0.81       958
           7       0.94      0.48      0.63      1028
           8       0.26      0.92      0.41       974
           9       0.68      0.26      0.38      1009

   micro avg       0.60      0.60      0.60     10000
   macro avg       0.76      0.61      0.60     10000
weighted avg       0.77      0.60      0.59     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
('Projected data shape:', (9, 60000, 20, 20, 1))
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 17s 37ms/step - loss: 0.4950 - acc: 0.8457
Epoch 2/12

469/468 [==============================] - 10s 22ms/step - loss: 0.2019 - acc: 0.9392
Epoch 3/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1507 - acc: 0.9545
Epoch 4/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1289 - acc: 0.9609
Epoch 5/12

469/468 [==============================] - 11s 22ms/step - loss: 0.1176 - acc: 0.9633
Epoch 6/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0992 - acc: 0.9699
Epoch 7/12

469/468 [==============================] - 11s 22ms/step - loss: 0.0896 - acc: 0.9715
Epoch 8/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0818 - acc: 0.9737
Epoch 9/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0741 - acc: 0.9769
Epoch 10/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0678 - acc: 0.9773
Epoch 11/12

469/468 [==============================] - 11s 22ms/step - loss: 0.0617 - acc: 0.9798
Epoch 12/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0625 - acc: 0.9798
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 18s 38ms/step - loss: 0.5037 - acc: 0.8431
Epoch 2/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1996 - acc: 0.9397
Epoch 3/12

469/468 [==============================] - 10s 22ms/step - loss: 0.1527 - acc: 0.9544
Epoch 4/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1284 - acc: 0.9600
Epoch 5/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1088 - acc: 0.9660
Epoch 6/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0985 - acc: 0.9691
Epoch 7/12

469/468 [==============================] - 11s 22ms/step - loss: 0.0875 - acc: 0.9723
Epoch 8/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0784 - acc: 0.9755
Epoch 9/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0775 - acc: 0.9753
Epoch 10/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0678 - acc: 0.9778
Epoch 11/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0652 - acc: 0.9793
Epoch 12/12

469/468 [==============================] - 11s 22ms/step - loss: 0.0587 - acc: 0.9803
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 18s 38ms/step - loss: 0.5116 - acc: 0.8385
Epoch 2/12

469/468 [==============================] - 11s 23ms/step - loss: 0.2047 - acc: 0.9386
Epoch 3/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1549 - acc: 0.9536
Epoch 4/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1322 - acc: 0.9603
Epoch 5/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1137 - acc: 0.9655
Epoch 6/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0958 - acc: 0.9698
Epoch 7/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0860 - acc: 0.9734
Epoch 8/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0790 - acc: 0.9753
Epoch 9/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0758 - acc: 0.9756
Epoch 10/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0675 - acc: 0.9785
Epoch 11/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0654 - acc: 0.9794
Epoch 12/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0604 - acc: 0.9804
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 18s 38ms/step - loss: 0.5099 - acc: 0.8422
Epoch 2/12

469/468 [==============================] - 11s 23ms/step - loss: 0.2072 - acc: 0.9385
Epoch 3/12

469/468 [==============================] - 11s 22ms/step - loss: 0.1591 - acc: 0.9514
Epoch 4/12

469/468 [==============================] - 11s 22ms/step - loss: 0.1321 - acc: 0.9603
Epoch 5/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1110 - acc: 0.9658
Epoch 6/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0988 - acc: 0.9693
Epoch 7/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0912 - acc: 0.9716
Epoch 8/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0827 - acc: 0.9737
Epoch 9/12

469/468 [==============================] - 11s 22ms/step - loss: 0.0749 - acc: 0.9765
Epoch 10/12

469/468 [==============================] - 11s 22ms/step - loss: 0.0721 - acc: 0.9771
Epoch 11/12

469/468 [==============================] - 10s 22ms/step - loss: 0.0648 - acc: 0.9798
Epoch 12/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0630 - acc: 0.9802
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 18s 39ms/step - loss: 0.4996 - acc: 0.8435
Epoch 2/12

469/468 [==============================] - 11s 23ms/step - loss: 0.2069 - acc: 0.9378
Epoch 3/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1602 - acc: 0.9507
Epoch 4/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1328 - acc: 0.9606
Epoch 5/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1167 - acc: 0.9642
Epoch 6/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1012 - acc: 0.9684
Epoch 7/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0914 - acc: 0.9713
Epoch 8/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0867 - acc: 0.9732
Epoch 9/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0761 - acc: 0.9753
Epoch 10/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0734 - acc: 0.9764
Epoch 11/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0691 - acc: 0.9780
Epoch 12/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0648 - acc: 0.9789
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 18s 39ms/step - loss: 0.4911 - acc: 0.8455
Epoch 2/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1974 - acc: 0.9408
Epoch 3/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1545 - acc: 0.9538
Epoch 4/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1275 - acc: 0.9618
Epoch 5/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1132 - acc: 0.9652
Epoch 6/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0988 - acc: 0.9697
Epoch 7/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0883 - acc: 0.9727
Epoch 8/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0816 - acc: 0.9740
Epoch 9/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0743 - acc: 0.9762
Epoch 10/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0707 - acc: 0.9776
Epoch 11/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0665 - acc: 0.9789
Epoch 12/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0599 - acc: 0.9804
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 19s 40ms/step - loss: 0.4729 - acc: 0.8551
Epoch 2/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1958 - acc: 0.9412
Epoch 3/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1510 - acc: 0.9546
Epoch 4/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1270 - acc: 0.9615
Epoch 5/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1043 - acc: 0.9676
Epoch 6/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0959 - acc: 0.9705
Epoch 7/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0863 - acc: 0.9735
Epoch 8/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0801 - acc: 0.9747
Epoch 9/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0737 - acc: 0.9763
Epoch 10/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0676 - acc: 0.9781
Epoch 11/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0622 - acc: 0.9805
Epoch 12/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0590 - acc: 0.9808
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 19s 40ms/step - loss: 0.4881 - acc: 0.8466
Epoch 2/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1997 - acc: 0.9407
Epoch 3/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1484 - acc: 0.9546
Epoch 4/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1219 - acc: 0.9625
Epoch 5/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1049 - acc: 0.9681
Epoch 6/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0962 - acc: 0.9706
Epoch 7/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0843 - acc: 0.9735
Epoch 8/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0753 - acc: 0.9767
Epoch 9/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0730 - acc: 0.9772
Epoch 10/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0661 - acc: 0.9789
Epoch 11/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0639 - acc: 0.9795
Epoch 12/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0555 - acc: 0.9826
('\nTraining infos:\nbatch_size = ', 128, '\nepochs =', 12, '\nx_train.shape = ', (60000, 20, 20, 1), '\ny_train.shape = ', (60000, 10), '\n')
Epoch 1/12

469/468 [==============================] - 19s 40ms/step - loss: 0.4992 - acc: 0.8443
Epoch 2/12

469/468 [==============================] - 11s 23ms/step - loss: 0.2004 - acc: 0.9403
Epoch 3/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1507 - acc: 0.9547
Epoch 4/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1253 - acc: 0.9610
Epoch 5/12

469/468 [==============================] - 11s 23ms/step - loss: 0.1090 - acc: 0.9664
Epoch 6/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0969 - acc: 0.9703
Epoch 7/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0879 - acc: 0.9725
Epoch 8/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0810 - acc: 0.9745
Epoch 9/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0743 - acc: 0.9764
Epoch 10/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0643 - acc: 0.9793
Epoch 11/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0633 - acc: 0.9802
Epoch 12/12

469/468 [==============================] - 11s 23ms/step - loss: 0.0613 - acc: 0.9806
('\nTraining time for model (n_proj=', 9, ', size_proj=', 20, '): --- 1229.960742 seconds ---')
('\nTesting infos:\nx_test.shape = ', (10000, 28, 28, 1), '\ny_test.shape = ', (10000, 10), '\n')

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (9, 10000, 20, 20, 1))
Correctly classified: 9818
Incorrectly classified: 182
Test accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.98      0.99      0.99       980
           1       0.99      0.99      0.99      1135
           2       0.98      0.98      0.98      1032
           3       0.98      0.98      0.98      1010
           4       0.98      0.98      0.98       982
           5       0.99      0.98      0.98       892
           6       0.98      0.99      0.98       958
           7       0.98      0.98      0.98      1028
           8       0.98      0.97      0.98       974
           9       0.98      0.97      0.97      1009

   micro avg       0.98      0.98      0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000

('\nAdversarial evaluation using', 'fgsm', 'method.')
(10000, 10000)

Computing random projections.
('Input shape: ', (10000, 28, 28, 1))
('Projected data shape:', (9, 10000, 20, 20, 1))

Adversarial test data.
Correctly classified: 5929
Incorrectly classified: 4071
Adversarial accuracy: 0.00%
              precision    recall  f1-score   support

           0       0.96      0.83      0.89       980
           1       1.00      0.00      0.01      1135
           2       0.71      0.87      0.79      1032
           3       0.69      0.81      0.74      1010
           4       0.69      0.58      0.63       982
           5       0.84      0.57      0.68       892
           6       0.93      0.74      0.82       958
           7       0.96      0.47      0.63      1028
           8       0.25      0.93      0.39       974
           9       0.66      0.23      0.34      1009

   micro avg       0.59      0.59      0.59     10000
   macro avg       0.77      0.60      0.59     10000
weighted avg       0.77      0.59      0.58     10000


Computing random projections.
('Input shape: ', (60000, 28, 28, 1))
