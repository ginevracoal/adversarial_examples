
Loading the model.

===== Adversarial training =====

Generating adversaries with deepfool method on  cifar

Training infos:
batch_size =  128 
epochs = 120 
x_train.shape =  (200, 32, 32, 3) 
y_train.shape =  (200, 10) 

Epoch 1/120

2/1 [======================================] - 2s 1s/step - loss: 3.3136 - acc: 0.1133
Epoch 2/120

2/1 [======================================] - 1s 268ms/step - loss: 3.6050 - acc: 0.1211
Epoch 3/120

2/1 [======================================] - 1s 286ms/step - loss: 3.3817 - acc: 0.1250
Epoch 4/120

2/1 [======================================] - 1s 272ms/step - loss: 3.4231 - acc: 0.1016
Epoch 5/120

2/1 [======================================] - 1s 263ms/step - loss: 3.1829 - acc: 0.1484
Epoch 6/120

2/1 [======================================] - 1s 265ms/step - loss: 3.2249 - acc: 0.1562
Epoch 7/120

2/1 [======================================] - 1s 266ms/step - loss: 2.8998 - acc: 0.1602
Epoch 8/120

2/1 [======================================] - 1s 284ms/step - loss: 2.7328 - acc: 0.2422
Epoch 9/120

2/1 [======================================] - 1s 254ms/step - loss: 2.7972 - acc: 0.2109
Epoch 10/120

2/1 [======================================] - 1s 264ms/step - loss: 2.8020 - acc: 0.1992
Epoch 11/120

2/1 [======================================] - 1s 294ms/step - loss: 2.6915 - acc: 0.2344
Epoch 12/120

2/1 [======================================] - 1s 269ms/step - loss: 2.5822 - acc: 0.2031
Epoch 13/120

2/1 [======================================] - 1s 275ms/step - loss: 2.2280 - acc: 0.2266
Epoch 14/120

2/1 [======================================] - 1s 265ms/step - loss: 2.4159 - acc: 0.2461
Epoch 15/120

2/1 [======================================] - 1s 278ms/step - loss: 2.3775 - acc: 0.2656
Epoch 16/120

2/1 [======================================] - 1s 261ms/step - loss: 2.2352 - acc: 0.3125
Epoch 17/120

2/1 [======================================] - 1s 264ms/step - loss: 2.0705 - acc: 0.3320
Epoch 18/120

2/1 [======================================] - 1s 280ms/step - loss: 2.0798 - acc: 0.3477
Epoch 19/120

2/1 [======================================] - 1s 290ms/step - loss: 2.0409 - acc: 0.3633
Epoch 20/120

2/1 [======================================] - 1s 278ms/step - loss: 1.9874 - acc: 0.3750
Epoch 21/120

2/1 [======================================] - 1s 262ms/step - loss: 1.8207 - acc: 0.4180
Epoch 22/120

2/1 [======================================] - 1s 296ms/step - loss: 1.9650 - acc: 0.3867
Epoch 23/120

2/1 [======================================] - 1s 272ms/step - loss: 1.7397 - acc: 0.4180
Epoch 24/120

2/1 [======================================] - 1s 276ms/step - loss: 1.8321 - acc: 0.3750
Epoch 25/120

2/1 [======================================] - 1s 286ms/step - loss: 1.8258 - acc: 0.4180
Epoch 26/120

2/1 [======================================] - 1s 283ms/step - loss: 1.5582 - acc: 0.5273
Epoch 27/120

2/1 [======================================] - 1s 304ms/step - loss: 1.7096 - acc: 0.4258
Epoch 28/120

2/1 [======================================] - 1s 287ms/step - loss: 1.7123 - acc: 0.4375
Epoch 29/120

2/1 [======================================] - 1s 287ms/step - loss: 1.6138 - acc: 0.4844
Epoch 30/120

2/1 [======================================] - 1s 287ms/step - loss: 1.6287 - acc: 0.4883
Epoch 31/120

2/1 [======================================] - 1s 305ms/step - loss: 1.6572 - acc: 0.4688
Epoch 32/120

2/1 [======================================] - 1s 281ms/step - loss: 1.6363 - acc: 0.4180
Epoch 33/120

2/1 [======================================] - 1s 295ms/step - loss: 1.4291 - acc: 0.5078
Epoch 34/120

2/1 [======================================] - 1s 294ms/step - loss: 1.4414 - acc: 0.5117
Epoch 35/120

2/1 [======================================] - 1s 290ms/step - loss: 1.3734 - acc: 0.5312
Epoch 36/120

2/1 [======================================] - 1s 331ms/step - loss: 1.4114 - acc: 0.4883
Epoch 37/120

2/1 [======================================] - 1s 326ms/step - loss: 1.2935 - acc: 0.5234
Epoch 38/120

2/1 [======================================] - 1s 284ms/step - loss: 1.3382 - acc: 0.5312
Epoch 39/120

2/1 [======================================] - 1s 309ms/step - loss: 1.3006 - acc: 0.5703
Epoch 40/120

2/1 [======================================] - 1s 276ms/step - loss: 1.2185 - acc: 0.5547
Epoch 41/120

2/1 [======================================] - 1s 275ms/step - loss: 1.3151 - acc: 0.5273
Epoch 42/120

2/1 [======================================] - 1s 289ms/step - loss: 1.1943 - acc: 0.5820
Epoch 43/120

2/1 [======================================] - 1s 290ms/step - loss: 1.1324 - acc: 0.6172
Epoch 44/120

2/1 [======================================] - 1s 284ms/step - loss: 1.1830 - acc: 0.5742
Epoch 45/120

2/1 [======================================] - 1s 267ms/step - loss: 1.0823 - acc: 0.6367
Epoch 46/120

2/1 [======================================] - 1s 283ms/step - loss: 1.1734 - acc: 0.5977
Epoch 47/120

2/1 [======================================] - 1s 304ms/step - loss: 1.0616 - acc: 0.6445
Epoch 48/120

2/1 [======================================] - 1s 349ms/step - loss: 1.0096 - acc: 0.6367
Epoch 49/120

2/1 [======================================] - 1s 296ms/step - loss: 1.0561 - acc: 0.6367
Epoch 50/120

2/1 [======================================] - 1s 321ms/step - loss: 0.9619 - acc: 0.7109
Epoch 51/120

2/1 [======================================] - 1s 307ms/step - loss: 0.8906 - acc: 0.7344
Epoch 52/120

2/1 [======================================] - 1s 284ms/step - loss: 1.0581 - acc: 0.6250
Epoch 53/120

2/1 [======================================] - 1s 282ms/step - loss: 1.0511 - acc: 0.6172
Epoch 54/120

2/1 [======================================] - 1s 283ms/step - loss: 1.0061 - acc: 0.6523
Epoch 55/120

2/1 [======================================] - 1s 295ms/step - loss: 1.0152 - acc: 0.6406
Epoch 56/120

2/1 [======================================] - 1s 311ms/step - loss: 0.8054 - acc: 0.7500
Epoch 57/120

2/1 [======================================] - 1s 279ms/step - loss: 0.8938 - acc: 0.6875
Epoch 58/120

2/1 [======================================] - 1s 296ms/step - loss: 0.8639 - acc: 0.7070
Epoch 59/120

2/1 [======================================] - 1s 295ms/step - loss: 0.9393 - acc: 0.7109
Epoch 60/120

2/1 [======================================] - 1s 287ms/step - loss: 0.8733 - acc: 0.7031
Epoch 61/120

2/1 [======================================] - 1s 274ms/step - loss: 0.8592 - acc: 0.6836
Epoch 62/120

2/1 [======================================] - 1s 290ms/step - loss: 0.8272 - acc: 0.6992
Epoch 63/120

2/1 [======================================] - 1s 276ms/step - loss: 0.8035 - acc: 0.7344
Epoch 64/120

2/1 [======================================] - 1s 285ms/step - loss: 0.7239 - acc: 0.7852
Epoch 65/120

2/1 [======================================] - 1s 306ms/step - loss: 0.7296 - acc: 0.7344
Epoch 66/120

2/1 [======================================] - 1s 276ms/step - loss: 0.8656 - acc: 0.7109
Epoch 67/120

2/1 [======================================] - 1s 289ms/step - loss: 0.7576 - acc: 0.7617
Epoch 68/120

2/1 [======================================] - 1s 285ms/step - loss: 0.7744 - acc: 0.7500
Epoch 69/120

2/1 [======================================] - 1s 288ms/step - loss: 0.7489 - acc: 0.7617
Epoch 70/120

2/1 [======================================] - 1s 302ms/step - loss: 0.7201 - acc: 0.7734
Epoch 71/120

2/1 [======================================] - 1s 294ms/step - loss: 0.7525 - acc: 0.7305
Epoch 72/120

2/1 [======================================] - 1s 279ms/step - loss: 0.6815 - acc: 0.7734
Epoch 73/120

2/1 [======================================] - 1s 282ms/step - loss: 0.7202 - acc: 0.7422
Epoch 74/120

2/1 [======================================] - 1s 297ms/step - loss: 0.6915 - acc: 0.7656
Epoch 75/120

2/1 [======================================] - 1s 295ms/step - loss: 0.6186 - acc: 0.8086
Epoch 76/120

2/1 [======================================] - 1s 281ms/step - loss: 0.6544 - acc: 0.7891
Epoch 77/120

2/1 [======================================] - 1s 266ms/step - loss: 0.6545 - acc: 0.7891
Epoch 78/120

2/1 [======================================] - 1s 277ms/step - loss: 0.6545 - acc: 0.7891
Epoch 79/120

2/1 [======================================] - 1s 278ms/step - loss: 0.5164 - acc: 0.8203
Epoch 80/120

2/1 [======================================] - 1s 270ms/step - loss: 0.6491 - acc: 0.8125
Epoch 81/120

2/1 [======================================] - 1s 274ms/step - loss: 0.5940 - acc: 0.7930
Epoch 82/120

2/1 [======================================] - 1s 265ms/step - loss: 0.6276 - acc: 0.7539
Epoch 83/120

2/1 [======================================] - 1s 294ms/step - loss: 0.5638 - acc: 0.8047
Epoch 84/120

2/1 [======================================] - 1s 273ms/step - loss: 0.5233 - acc: 0.8320
Epoch 85/120

2/1 [======================================] - 1s 302ms/step - loss: 0.6300 - acc: 0.7930
Epoch 86/120

2/1 [======================================] - 1s 271ms/step - loss: 0.4612 - acc: 0.8789
Epoch 87/120

2/1 [======================================] - 1s 269ms/step - loss: 0.6036 - acc: 0.8008
Epoch 88/120

2/1 [======================================] - 1s 277ms/step - loss: 0.5227 - acc: 0.8477
Epoch 89/120

2/1 [======================================] - 1s 267ms/step - loss: 0.5627 - acc: 0.8164
Epoch 90/120

2/1 [======================================] - 1s 270ms/step - loss: 0.5555 - acc: 0.8125
Epoch 91/120

2/1 [======================================] - 1s 273ms/step - loss: 0.5024 - acc: 0.8438
Epoch 92/120

2/1 [======================================] - 1s 278ms/step - loss: 0.5334 - acc: 0.8438
Epoch 93/120

2/1 [======================================] - 1s 281ms/step - loss: 0.4960 - acc: 0.8477
Epoch 94/120

2/1 [======================================] - 1s 266ms/step - loss: 0.5045 - acc: 0.8594
Epoch 95/120

2/1 [======================================] - 1s 264ms/step - loss: 0.5085 - acc: 0.8594
Epoch 96/120

2/1 [======================================] - 1s 271ms/step - loss: 0.5401 - acc: 0.8477
Epoch 97/120

2/1 [======================================] - 1s 273ms/step - loss: 0.5383 - acc: 0.8242
Epoch 98/120

2/1 [======================================] - 1s 293ms/step - loss: 0.3898 - acc: 0.9023
Epoch 99/120

2/1 [======================================] - 1s 284ms/step - loss: 0.4450 - acc: 0.8750
Epoch 100/120

2/1 [======================================] - 1s 295ms/step - loss: 0.3887 - acc: 0.8789
Epoch 101/120

2/1 [======================================] - 1s 293ms/step - loss: 0.4481 - acc: 0.8828
Epoch 102/120

2/1 [======================================] - 1s 263ms/step - loss: 0.4410 - acc: 0.8594
Epoch 103/120

2/1 [======================================] - 1s 266ms/step - loss: 0.4510 - acc: 0.8750
Epoch 104/120

2/1 [======================================] - 1s 294ms/step - loss: 0.3802 - acc: 0.9102
Epoch 105/120

2/1 [======================================] - 1s 267ms/step - loss: 0.3731 - acc: 0.9062
Epoch 106/120

2/1 [======================================] - 1s 276ms/step - loss: 0.3856 - acc: 0.8945
Epoch 107/120

2/1 [======================================] - 1s 305ms/step - loss: 0.4302 - acc: 0.8633
Epoch 108/120

2/1 [======================================] - 1s 289ms/step - loss: 0.3455 - acc: 0.9102
Epoch 109/120

2/1 [======================================] - 1s 286ms/step - loss: 0.4274 - acc: 0.8594
Epoch 110/120

2/1 [======================================] - 1s 271ms/step - loss: 0.4327 - acc: 0.8555
Epoch 111/120

2/1 [======================================] - 1s 306ms/step - loss: 0.4332 - acc: 0.8633
Epoch 112/120

2/1 [======================================] - 1s 268ms/step - loss: 0.3958 - acc: 0.8789
Epoch 113/120

2/1 [======================================] - 1s 275ms/step - loss: 0.3448 - acc: 0.8867
Epoch 114/120

2/1 [======================================] - 1s 284ms/step - loss: 0.2639 - acc: 0.9414
Epoch 115/120

2/1 [======================================] - 1s 293ms/step - loss: 0.3318 - acc: 0.9141
Epoch 116/120

2/1 [======================================] - 1s 277ms/step - loss: 0.3009 - acc: 0.9180
Epoch 117/120

2/1 [======================================] - 1s 310ms/step - loss: 0.3839 - acc: 0.8828
Epoch 118/120

2/1 [======================================] - 1s 313ms/step - loss: 0.3615 - acc: 0.9023
Epoch 119/120

2/1 [======================================] - 1s 275ms/step - loss: 0.2956 - acc: 0.9297
Epoch 120/120

2/1 [======================================] - 1s 304ms/step - loss: 0.3516 - acc: 0.9023

Training time: --- 70.31249904632568 seconds ---

Adversarial training time: --- 78.85096383094788 seconds ---

Evaluating on original test set:

===== Test set evaluation =====

Testing infos:
x_test.shape =  (100, 32, 32, 3) 
y_test.shape =  (100, 10) 

Correctly classified: 23
Incorrectly classified: 77
Test accuracy: 23.00%
              precision    recall  f1-score   support

           0       1.00      0.20      0.33        10
           1       0.50      0.33      0.40         6
           2       0.23      0.38      0.29         8
           3       0.18      0.30      0.22        10
           4       0.14      0.57      0.23         7
           5       0.00      0.00      0.00         8
           6       0.40      0.12      0.19        16
           7       0.67      0.18      0.29        11
           8       0.00      0.00      0.00        13
           9       0.19      0.45      0.27        11

   micro avg       0.23      0.23      0.23       100
   macro avg       0.33      0.25      0.22       100
weighted avg       0.33      0.23      0.21       100


Evaluating on adversarial test set generated from the original classifier:

===== Adversarial evaluation =====

Loading adversaries generated with deepfool method on  cifar

Adversarial test data.
Correctly classified: 24
Incorrectly classified: 76
Adversarial accuracy: 24.00%
              precision    recall  f1-score   support

           0       0.67      0.20      0.31        10
           1       0.50      0.33      0.40         6
           2       0.23      0.38      0.29         8
           3       0.18      0.30      0.22        10
           4       0.15      0.57      0.24         7
           5       0.00      0.00      0.00         8
           6       0.40      0.12      0.19        16
           7       0.67      0.18      0.29        11
           8       1.00      0.08      0.14        13
           9       0.20      0.45      0.28        11

   micro avg       0.24      0.24      0.24       100
   macro avg       0.40      0.26      0.23       100
weighted avg       0.43      0.24      0.23       100


===== Test set evaluation =====

Testing infos:
x_test.shape =  (100, 32, 32, 3) 
y_test.shape =  (100, 10) 

Correctly classified: 81
Incorrectly classified: 19
Test accuracy: 81.00%
              precision    recall  f1-score   support

           0       1.00      0.80      0.89        10
           1       1.00      0.67      0.80         6
           2       1.00      0.62      0.77         8
           3       0.54      0.70      0.61        10
           4       0.60      0.86      0.71         7
           5       0.57      0.50      0.53         8
           6       0.93      0.88      0.90        16
           7       0.90      0.82      0.86        11
           8       0.93      1.00      0.96        13
           9       0.79      1.00      0.88        11

   micro avg       0.81      0.81      0.81       100
   macro avg       0.83      0.78      0.79       100
weighted avg       0.84      0.81      0.81       100


===== Adversarial evaluation =====

Generating adversaries with deepfool method on  cifar

Adversarial test data.
Correctly classified: 10
Incorrectly classified: 90
Adversarial accuracy: 10.00%
              precision    recall  f1-score   support

           0       0.12      0.10      0.11        10
           1       0.33      0.33      0.33         6
           2       0.14      0.12      0.13         8
           3       0.33      0.30      0.32        10
           4       0.00      0.00      0.00         7
           5       0.17      0.25      0.20         8
           6       0.09      0.06      0.07        16
           7       0.00      0.00      0.00        11
           8       0.00      0.00      0.00        13
           9       0.00      0.00      0.00        11

   micro avg       0.10      0.10      0.10       100
   macro avg       0.12      0.12      0.12       100
weighted avg       0.11      0.10      0.10       100

